<!DOCTYPE html>
<html lang="ru" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <base href="../../../../../../" />
        <title>SDK КОМПАС-3D</title>
        <link rel="canonical" href="ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html">
        <link rel="alternate" href="ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html" hreflang="ru" />
        <meta name="generator" content="Diplodoc Platform v5.15.6">
        
        <style type="text/css">html, body {min-height:100vh; height:100vh;}</style>
        
        
        <link type="text/css" rel="stylesheet" href="_bundle\vendor-593a6546600e304d.css"/>
        <link type="text/css" rel="stylesheet" href="_bundle\app-78e49b3fc9a05a8f.css"/>
    </head>
    <body class="g-root g-root_theme_light">
        <div id="root"></div>
        <script type="application/json" id="diplodoc-state">
            {"data":{"leading":false,"html":"&lt;h1&gt;&lt;strong&gt;Интерфейс IKompasCollection&lt;/strong&gt;&lt;/h1&gt;\n&lt;h2 id=\"ierarhiya-nasledovaniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#ierarhiya-nasledovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Иерархия наследования&lt;/span&gt;&lt;/a&gt;Иерархия наследования&lt;/h2&gt;\n&lt;style&gt;.top-parent {\n  color: #ffe3d8;\n  background: green;\n  border: 3px solid #046709;\n  border-radius: 4px;\n  padding: 5px;\n  text-align: center;\n  margin-bottom: 5px;\n  font-weight: bold;\n  width: 40%;\n  max-width: 220px;\n}\n\n.other-parents {\n  color: #ffe3d8;\n  background: #4a6fa5;\n  border: 3px solid #3d5b87;\n  border-radius: 4px;\n  padding: 5px;\n  text-align: center;\n  margin: 5px 10%;\n  font-weight: bold;\n  width: 40%;\n  max-width: 220px;\n}\n\n.interface {\n  color: #ffe3d8;\n  background: #103874;\n  border: 3px solid #002152;\n  border-radius: 4px;\n  padding: 5px;\n  text-align: center;\n  margin: 5px 10%;\n  font-weight: bold;\n  width: 40%;\n  max-width: 220px;\n}&lt;/style&gt;\n&lt;div style=\"padding:10px;background:#f5f5f5;border-radius:5px;max-width:auto;margin-bottom:20px\"&gt;\n&lt;div class=\"top-parent\"&gt;IAPIObject&lt;/div&gt;\n&lt;div style=\"text-align:left;color:black;margin:5px 15%\"&gt;▼&lt;/div&gt;\n&lt;div class=\"other-parents\"&gt;IKompasAPIObject&lt;/div&gt;\n&lt;div style=\"text-align:left;color:black;margin:5px 25%\"&gt;▼&lt;/div&gt;\n&lt;div class=\"interface\" style=\"margin:5px 30%\"&gt;IKompasCollection&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"mermaid\" data-content=\"graph%20TD%0A%20%20%20%20A%5BIAPIObject%5D%20--%3E%20B%5BIKompasAPIObject%5D%0A%20%20%20%20B%20--%3E%20C%5BIKompasCollection%5D%0A\"&gt;&lt;/div&gt;&lt;h2 id=\"obshee-opisanie\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#obshee-opisanie\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Общее описание&lt;/span&gt;&lt;/a&gt;Общее описание&lt;/h2&gt;\n&lt;p&gt;Базовый интерфейс для работы с коллекциями объектов в КОМПАС API. Предоставляет унифицированный способ доступа к группам объектов различных типов: документам, слоям, видам, объектам чертежа, моделям и другим коллекциям.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Основные характеристики:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Наследуется от &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/interface_page_files/IKompasAPIObject.html\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-5j4yrqqm\"&gt;IKompasAPIObject&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Является базовым для более чем 30 специализированных интерфейсов коллекций&lt;/li&gt;\n&lt;li&gt;Поддерживает итерацию по объектам и получение количества элементов&lt;/li&gt;\n&lt;li&gt;Не предоставляет методов для добавления/удаления объектов (это реализуется в потомках)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\"vazhnye-primechaniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#vazhnye-primechaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Важные примечания&lt;/span&gt;&lt;/a&gt;Важные примечания&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;IKompasCollection&lt;/strong&gt; - это базовый интерфейс с минимальным набором методов. Конкретные коллекции (например, &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/interface_page_files/ICircles.html\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-0lrlmbxo\"&gt;ICircles&lt;/code&gt;&lt;/a&gt; добавляют свои методы для создания, удаления и модификации объектов.&lt;/li&gt;\n&lt;li&gt;Метод &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getobjects\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ja50z5hb\"&gt;GetObjects()&lt;/code&gt;&lt;/a&gt; возвращает копию массива объектов, что может быть накладно для больших коллекций. Используйте &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getcount\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-l5qta9o8\"&gt;GetCount()&lt;/code&gt;&lt;/a&gt; + индексный доступ в потомках для оптимизации.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\"poluchenie-interfejsa\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#poluchenie-interfejsa\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Получение интерфейса&lt;/span&gt;&lt;/a&gt;Получение интерфейса&lt;/h2&gt;\n&lt;h3 id=\"osnovnye-sposoby-polucheniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#osnovnye-sposoby-polucheniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Основные способы получения:&lt;/span&gt;&lt;/a&gt;Основные способы получения:&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Получение наследника интерфейса:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/interface_page_files/ICircles.html\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-n98p5y4s\"&gt;IDrawingContainer::GetCircles()&lt;/code&gt;&lt;/a&gt; - коллекция окружностей вида&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Через QueryInterface:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Приведение от специализированных коллекций к базовому &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-myu0bh7h\"&gt;IKompasCollection&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\"primery-polucheniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primery-polucheniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Примеры получения:&lt;/span&gt;&lt;/a&gt;Примеры получения:&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Пример 1: Получение коллекции документов из приложения&lt;/span&gt;\nksapi::IKompasApplicationPtr kompasApp = ...;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\n&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; docCount = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;();\n\n&lt;span class=\"hljs-comment\"&gt;// Пример 2: Получение коллекции листов оформления из документа&lt;/span&gt;\nksapi::IKompasDocument2DPtr doc2D = ...;\nksapi::ILayoutSheetsPtr layoutSheets = doc2D-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheets&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (layoutSheets &amp;amp;&amp;amp; layoutSheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;() &amp;gt; &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;)\n{\n    &lt;span class=\"hljs-comment\"&gt;// Работа с листами&lt;/span&gt;\n}\n\n&lt;span class=\"hljs-comment\"&gt;// Пример 3: Получение коллекции групп чертежа&lt;/span&gt;\nksapi::IDrawingGroupsPtr groups = doc2D-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDrawingGroups&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt; objects = groups-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"93\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-93\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-93\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-93.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h2 id=\"dopolnitelnye-interfejsy\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#dopolnitelnye-interfejsy\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Дополнительные интерфейсы&lt;/span&gt;&lt;/a&gt;Дополнительные интерфейсы&lt;/h2&gt;\n&lt;p&gt;Интерфейс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-wkc90p3i\"&gt;IKompasCollection&lt;/code&gt; является базовым. Ниже перечислены примеры интерфейсов, которые &lt;strong&gt;наследуются&lt;/strong&gt; от него:&lt;/p&gt;\n&lt;h3 id=\"kollekcii-dokumentov-i-bibliotek\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-dokumentov-i-bibliotek\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Коллекции документов и библиотек:&lt;/span&gt;&lt;/a&gt;Коллекции документов и библиотек:&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-fim2knrq\"&gt;IDocuments&lt;/code&gt;&lt;/strong&gt; - коллекция открытых документов&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-pn33jttv\"&gt;IInsertsLibraries&lt;/code&gt;&lt;/strong&gt; - коллекция библиотек вставок&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"kollekcii-chertezha-2d\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-chertezha-2d\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Коллекции чертежа (2D):&lt;/span&gt;&lt;/a&gt;Коллекции чертежа (2D):&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ml3s16k6\"&gt;ILayoutSheets&lt;/code&gt;&lt;/strong&gt; - листы оформления&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-bxz4yk01\"&gt;IDrawingObjects&lt;/code&gt;&lt;/strong&gt; - объекты чертежа&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-z292voq5\"&gt;ILayers&lt;/code&gt;&lt;/strong&gt; - слои&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-j0h8yere\"&gt;ILocalCoordinateSystems2D&lt;/code&gt;&lt;/strong&gt; - локальные системы координат&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"kollekcii-modeli-3d\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-modeli-3d\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Коллекции модели (3D):&lt;/span&gt;&lt;/a&gt;Коллекции модели (3D):&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-x8qgm5wu\"&gt;IModelObjects&lt;/code&gt;&lt;/strong&gt; - объекты модели&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-fnqc0x1o\"&gt;ILayers3D&lt;/code&gt;&lt;/strong&gt; - слои 3D&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-25kri7mo\"&gt;ILayerGroups3D&lt;/code&gt;&lt;/strong&gt; - группы слоев 3D&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-y5272g7y\"&gt;IManipulators&lt;/code&gt;&lt;/strong&gt; - манипуляторы&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"kollekcii-specifikacii\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-specifikacii\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Коллекции спецификации:&lt;/span&gt;&lt;/a&gt;Коллекции спецификации:&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-obmwt0ue\"&gt;ISpecificationDescriptions&lt;/code&gt;&lt;/strong&gt; - описания спецификации&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-6a6fau5a\"&gt;ISpecificationBaseObjects&lt;/code&gt;&lt;/strong&gt; - базовые объекты спецификации&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\"metody-interfejsa\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#metody-interfejsa\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Методы интерфейса&lt;/span&gt;&lt;/a&gt;Методы интерфейса&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getobjects\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-gwxch8cf\"&gt;GetObjects()&lt;/code&gt;&lt;/a&gt; - получить массив объектов коллекции&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getcount\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-r1h2vdbj\"&gt;GetCount()&lt;/code&gt;&lt;/a&gt; - получить количество объектов в коллекции&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"getobjects\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getobjects\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;GetObjects()&lt;/span&gt;&lt;/a&gt;GetObjects()&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Возвращает массив всех объектов, содержащихся в коллекции.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nМетод возвращает копию вектора, содержащего все объекты коллекции. Каждый элемент является указателем типа &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vhzpvba5\"&gt;IKompasAPIObjectPtr&lt;/code&gt;, который может быть приведен к конкретному типу объекта в зависимости от типа коллекции.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; std::vector&amp;lt;IKompasAPIObjectPtr&amp;gt; &lt;span class=\"hljs-title\"&gt;GetObjects&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"211\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-211\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-211\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-211.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; Вектор указателей на объекты коллекции. Пустой вектор, если коллекция пуста.&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-ispolzovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Получение всех документов из приложения&lt;/span&gt;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt; allDocs = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"221\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-221\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-221\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-221.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Итерация по коллекции документов с проверкой типа&lt;/span&gt;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt;&amp;amp; doc : documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;())\n{\n    ksapi::IKompasDocument2DPtr doc2D = doc;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc2D)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Работа с 2D документом&lt;/span&gt;\n        &lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt; name = doc2D-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetName&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"225\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-225\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-225\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-225.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Метод возвращает &lt;strong&gt;копию&lt;/strong&gt; контейнера указателей. Копируются только сами указатели, а не объекты. Поэтому изменение состава или порядка элементов в возвращённом векторе не влияет на коллекцию документа, но изменение свойств объектов по этим указателям отражается в документе после вызова Update(), если этот метод есть.&lt;/li&gt;\n&lt;li&gt;Для больших коллекций рекомендуется использовать итераторы или прямой доступ по индексу&lt;/li&gt;\n&lt;li&gt;Тип &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-yuplff0b\"&gt;IKompasAPIObjectPtr&lt;/code&gt; требует приведения к конкретному типу для доступа к специализированным методам&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"getcount\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getcount\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;GetCount()&lt;/span&gt;&lt;/a&gt;GetCount()&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Возвращает количество объектов в коллекции.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nМетод возвращает целое число, обозначающее количество элементов в коллекции. Позволяет эффективно проверить пустоту коллекции и получить количество элементов для организации циклов.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;GetCount&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"262\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-262\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-262\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-262.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; Количество объектов в коллекции (&amp;gt;= 0).&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya1\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-ispolzovaniya1\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Проверка количества документов&lt;/span&gt;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;() &amp;gt; &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;)\n{\n    &lt;span class=\"hljs-comment\"&gt;// Есть документы&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"272\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-272\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-272\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-272.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Итерация по коллекции с использованием GetCount()&lt;/span&gt;\nksapi::ILayoutSheetsPtr layoutSheets = document-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheets&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; layoutSheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)\n{\n    ksapi::ILayoutSheetPtr sheet = layoutSheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheet&lt;/span&gt;(i);\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (sheet)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Работа с листом&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"276\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-276\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-276\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-276.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Более эффективный способ проверки пустоты: &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-xthqm24s\"&gt;collection-&amp;gt;GetCount() == 0&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Всегда возвращает неотрицательное значение&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"chastye-oshibki\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#chastye-oshibki\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Частые ошибки&lt;/span&gt;&lt;/a&gt;Частые ошибки&lt;/h2&gt;\n&lt;h3 id=\"1-ispolzovanie-getobjects-v-cikle-bez-neobhodimosti\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#1-ispolzovanie-getobjects-v-cikle-bez-neobhodimosti\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;1. Использование GetObjects() в цикле без необходимости&lt;/span&gt;&lt;/a&gt;1. &lt;strong&gt;Использование GetObjects() в цикле без необходимости&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// Метод GetObjects() создает копию массива на каждой итерации&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;size_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;().&lt;span class=\"hljs-built_in\"&gt;size&lt;/span&gt;(); i++)\n{\n    &lt;span class=\"hljs-comment\"&gt;// Работа с объектом&lt;/span&gt;\n}\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// Используем GetCount() для получения размера&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)\n{\n    &lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt; doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(i);\n    &lt;span class=\"hljs-comment\"&gt;// Работа с документом&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"299\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-299\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-299\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-299.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"2-otsutstvie-proverki-na-nullptr-posle-polucheniya-kollekcii\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#2-otsutstvie-proverki-na-nullptr-posle-polucheniya-kollekcii\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;2. Отсутствие проверки на nullptr после получения коллекции&lt;/span&gt;&lt;/a&gt;2. &lt;strong&gt;Отсутствие проверки на nullptr после получения коллекции&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nksapi::ILayoutSheetsPtr layoutSheets = document-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheets&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; layoutSheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)  &lt;span class=\"hljs-comment\"&gt;// Краш если layoutSheets == nullptr&lt;/span&gt;\n{\n    &lt;span class=\"hljs-comment\"&gt;// Работа&lt;/span&gt;\n}\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nksapi::ILayoutSheetsPtr layoutSheets = document-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheets&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!layoutSheets)\n    &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; layoutSheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)\n{\n    &lt;span class=\"hljs-comment\"&gt;// Работа&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"303\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-303\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-303\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-303.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"3-zabytaya-proverka-ukazatelya-na-obuekt-v-cikle\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#3-zabytaya-proverka-ukazatelya-na-obuekt-v-cikle\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;3. Забытая проверка указателя на объект в цикле&lt;/span&gt;&lt;/a&gt;3. &lt;strong&gt;Забытая проверка указателя на объект в цикле&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt;&amp;amp; obj : documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;())\n{\n    obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetActive&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Краш если obj == nullptr&lt;/span&gt;\n}\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt;&amp;amp; obj : documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;())\n{\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!obj)\n        &lt;span class=\"hljs-keyword\"&gt;continue&lt;/span&gt;;\n    obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetActive&lt;/span&gt;();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"307\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-307\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-307\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-307.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"4-pryamoe-izmenenie-vozvrashennogo-getobjects-vektora\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#4-pryamoe-izmenenie-vozvrashennogo-getobjects-vektora\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;4. Прямое изменение возвращенного GetObjects() вектора&lt;/span&gt;&lt;/a&gt;4. &lt;strong&gt;Прямое изменение возвращенного GetObjects() вектора&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt; objects = collection-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;();\nobjects.&lt;span class=\"hljs-built_in\"&gt;clear&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Не влияет на коллекцию!&lt;/span&gt;\nobjects.&lt;span class=\"hljs-built_in\"&gt;push_back&lt;/span&gt;(newObj);  &lt;span class=\"hljs-comment\"&gt;// Не добавляет в коллекцию!&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// Для добавления объектов используйте метод Add() конкретной коллекции&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt; newObj = collection-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Add&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"311\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-311\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-311\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-311.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"prakticheskie-primery-iz-ishodnikov\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#prakticheskie-primery-iz-ishodnikov\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Практические примеры из исходников&lt;/span&gt;&lt;/a&gt;Практические примеры из исходников&lt;/h2&gt;\n&lt;h3 id=\"primer-1-iteraciya-po-kollekcii-dokumentov\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-1-iteraciya-po-kollekcii-dokumentov\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример 1: Итерация по коллекции документов&lt;/span&gt;&lt;/a&gt;Пример 1: Итерация по коллекции документов&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Source/Steps/Step7/Step7.cpp (строки 140-167)&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (ksapi::IKompasDocument2DPtr document : documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;())\n{\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!document)\n        &lt;span class=\"hljs-keyword\"&gt;continue&lt;/span&gt;;\n\n    document-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetActive&lt;/span&gt;();\n\n    ksapi::IDrawingContainerPtr drawingContainer = &lt;span class=\"hljs-built_in\"&gt;GetDrawingContainer&lt;/span&gt;(*document);\n\n    &lt;span class=\"hljs-keyword\"&gt;switch&lt;/span&gt; (++i)\n    {\n        &lt;span class=\"hljs-keyword\"&gt;case&lt;/span&gt; &lt;span class=\"hljs-number\"&gt;1&lt;/span&gt;: &lt;span class=\"hljs-comment\"&gt;// В первом документе отрезок&lt;/span&gt;\n            &lt;span class=\"hljs-built_in\"&gt;CreateLineSegment&lt;/span&gt;(drawingContainer, &lt;span class=\"hljs-number\"&gt;20&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;10&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;40&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;10&lt;/span&gt;);\n            &lt;span class=\"hljs-keyword\"&gt;break&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;case&lt;/span&gt; &lt;span class=\"hljs-number\"&gt;2&lt;/span&gt;: &lt;span class=\"hljs-comment\"&gt;// Во втором документе окружность&lt;/span&gt;\n            &lt;span class=\"hljs-built_in\"&gt;CreateCircle&lt;/span&gt;(drawingContainer, &lt;span class=\"hljs-number\"&gt;50&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;50&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;20&lt;/span&gt;);\n            &lt;span class=\"hljs-keyword\"&gt;break&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;case&lt;/span&gt; &lt;span class=\"hljs-number\"&gt;3&lt;/span&gt;: &lt;span class=\"hljs-comment\"&gt;// В третьем документе дуга&lt;/span&gt;\n            &lt;span class=\"hljs-built_in\"&gt;CreateArc&lt;/span&gt;(drawingContainer, &lt;span class=\"hljs-number\"&gt;50&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;50&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;20&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;45&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;135&lt;/span&gt;);\n            &lt;span class=\"hljs-keyword\"&gt;break&lt;/span&gt;;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"319\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-319\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-319\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-319.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"primer-2-proverka-kolichestva-elementov\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-2-proverka-kolichestva-elementov\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример 2: Проверка количества элементов&lt;/span&gt;&lt;/a&gt;Пример 2: Проверка количества элементов&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Source/Steps/Step3a/Step3a.cpp (строки 283-285)&lt;/span&gt;\nksapi::ILayoutSheetsPtr layoutSheets = document.&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheets&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!layoutSheets || layoutSheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;() &amp;lt; &lt;span class=\"hljs-number\"&gt;1&lt;/span&gt;)\n    &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"323\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-323\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-323\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-323.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"primer-3-poluchenie-obuektov-kollekcii-dlya-otobrazheniya-polzovatelyu\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-3-poluchenie-obuektov-kollekcii-dlya-otobrazheniya-polzovatelyu\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример 3: Получение объектов коллекции для отображения пользователю&lt;/span&gt;&lt;/a&gt;Пример 3: Получение объектов коллекции для отображения пользователю&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Source/Steps/Step7/Step7.cpp (строки 284-288)&lt;/span&gt;\nksapi::IDrawingGroupsPtr namedGroups = document.&lt;span class=\"hljs-built_in\"&gt;GetNamedGroups&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!namedGroups)\n    &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt;;\n&lt;span class=\"hljs-built_in\"&gt;ShowObjectsToUser&lt;/span&gt;(document, namedGroups-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetObjects&lt;/span&gt;(), &lt;span class=\"hljs-string\"&gt;L\"группы\"&lt;/span&gt;);\n\nkompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;ShowMessageBox&lt;/span&gt;(std::format(&lt;span class=\"hljs-string\"&gt;L\"count = {}\"&lt;/span&gt;, namedGroups-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;()),\n                          &lt;span class=\"hljs-string\"&gt;L\"\"&lt;/span&gt;, ksMessageWarning, ksButtonSetOk, &lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"327\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-327\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-327\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-327.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"shablony-ispolzovaniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablony-ispolzovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблоны использования&lt;/span&gt;&lt;/a&gt;Шаблоны использования&lt;/h2&gt;\n&lt;h3 id=\"shablon-1-bezopasnaya-iteraciya-po-kollekcii\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablon-1-bezopasnaya-iteraciya-po-kollekcii\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблон 1: Безопасная итерация по коллекции&lt;/span&gt;&lt;/a&gt;Шаблон 1: Безопасная итерация по коллекции&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Описание: Итерация по коллекции с проверкой всех указателей&lt;/span&gt;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)\n{\n    ksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(i);\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!doc)\n        &lt;span class=\"hljs-keyword\"&gt;continue&lt;/span&gt;;\n    &lt;span class=\"hljs-comment\"&gt;// Работа с документом&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"335\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-335\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-335\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-335.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"shablon-2-proverka-pustoty-kollekcii\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablon-2-proverka-pustoty-kollekcii\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблон 2: Проверка пустоты коллекции&lt;/span&gt;&lt;/a&gt;Шаблон 2: Проверка пустоты коллекции&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Описание: Проверка наличия элементов в коллекции перед обработкой&lt;/span&gt;\nksapi::ILayoutSheetsPtr sheets = document-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheets&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!sheets || sheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;() == &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;)\n{\n    kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;ShowMessageBox&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Коллекция пуста\"&lt;/span&gt;, &lt;span class=\"hljs-string\"&gt;L\"\"&lt;/span&gt;, ksMessageWarning, ksButtonSetOk, &lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n    &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt;;\n}\n&lt;span class=\"hljs-comment\"&gt;// Обработка коллекции&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"339\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-339\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-339\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-339.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"shablon-3-poisk-obuekta-po-usloviyu\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablon-3-poisk-obuekta-po-usloviyu\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблон 3: Поиск объекта по условию&lt;/span&gt;&lt;/a&gt;Шаблон 3: Поиск объекта по условию&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Описание: Поиск конкретного объекта в коллекции&lt;/span&gt;\nksapi::ILayoutSheetsPtr sheets = document-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheets&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; sheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)\n{\n    ksapi::ILayoutSheetPtr sheet = sheets-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLayoutSheet&lt;/span&gt;(i);\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!sheet)\n        &lt;span class=\"hljs-keyword\"&gt;continue&lt;/span&gt;;\n\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (sheet-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetName&lt;/span&gt;() == &lt;span class=\"hljs-string\"&gt;L\"Чертеж1\"&lt;/span&gt;)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Найден нужный лист&lt;/span&gt;\n        &lt;span class=\"hljs-keyword\"&gt;break&lt;/span&gt;;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"343\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-343\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-343\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-343.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n","meta":{"metadata":[{"name":"generator","content":"Diplodoc Platform v5.15.6"}],"alternate":[{"href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html","hreflang":"ru"}],"script":["_bundle/mermaid-extension.js"],"canonical":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html","vcsPath":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.md"},"headings":[{"title":"Иерархия наследования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#ierarhiya-nasledovaniya","level":2},{"title":"Общее описание","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#obshee-opisanie","level":2},{"title":"Важные примечания","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#vazhnye-primechaniya","level":2},{"title":"Получение интерфейса","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#poluchenie-interfejsa","level":2,"items":[{"title":"Основные способы получения:","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#osnovnye-sposoby-polucheniya","level":3},{"title":"Примеры получения:","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primery-polucheniya","level":3}]},{"title":"Дополнительные интерфейсы","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#dopolnitelnye-interfejsy","level":2,"items":[{"title":"Коллекции документов и библиотек:","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-dokumentov-i-bibliotek","level":3},{"title":"Коллекции чертежа (2D):","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-chertezha-2d","level":3},{"title":"Коллекции модели (3D):","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-modeli-3d","level":3},{"title":"Коллекции спецификации:","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#kollekcii-specifikacii","level":3}]},{"title":"Методы интерфейса","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#metody-interfejsa","level":2,"items":[{"title":"GetObjects()","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getobjects","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-ispolzovaniya","level":4}]},{"title":"GetCount()","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#getcount","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-ispolzovaniya1","level":4}]}]},{"title":"Частые ошибки","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#chastye-oshibki","level":2,"items":[{"title":"1. Использование GetObjects() в цикле без необходимости","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#1-ispolzovanie-getobjects-v-cikle-bez-neobhodimosti","level":3},{"title":"2. Отсутствие проверки на nullptr после получения коллекции","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#2-otsutstvie-proverki-na-nullptr-posle-polucheniya-kollekcii","level":3},{"title":"3. Забытая проверка указателя на объект в цикле","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#3-zabytaya-proverka-ukazatelya-na-obuekt-v-cikle","level":3},{"title":"4. Прямое изменение возвращенного GetObjects() вектора","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#4-pryamoe-izmenenie-vozvrashennogo-getobjects-vektora","level":3}]},{"title":"Практические примеры из исходников","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#prakticheskie-primery-iz-ishodnikov","level":2,"items":[{"title":"Пример 1: Итерация по коллекции документов","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-1-iteraciya-po-kollekcii-dokumentov","level":3},{"title":"Пример 2: Проверка количества элементов","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-2-proverka-kolichestva-elementov","level":3},{"title":"Пример 3: Получение объектов коллекции для отображения пользователю","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#primer-3-poluchenie-obuektov-kollekcii-dlya-otobrazheniya-polzovatelyu","level":3}]},{"title":"Шаблоны использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablony-ispolzovaniya","level":2,"items":[{"title":"Шаблон 1: Безопасная итерация по коллекции","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablon-1-bezopasnaya-iteraciya-po-kollekcii","level":3},{"title":"Шаблон 2: Проверка пустоты коллекции","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablon-2-proverka-pustoty-kollekcii","level":3},{"title":"Шаблон 3: Поиск объекта по условию","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection.html#shablon-3-poisk-obuekta-po-usloviyu","level":3}]}],"title":""},"router":{"pathname":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IKompasCollection","depth":7,"base":"../../../../../../"},"lang":"ru","langs":["ru"],"viewerInterface":{"toc":true,"search":true,"feedback":true}}
        </script>
        <script type="application/javascript">
            const data = document.querySelector('script#diplodoc-state');
            window.__DATA__ = JSON.parse((function unescape(string) {
                return string.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&");
              })(data.innerText));
            window.STATIC_CONTENT = false;
        </script>
        <script type="application/javascript" defer src="ru/toc.js"></script>
        <script type="application/javascript" defer src="_bundle\vendor-cc74e4dafed769a9.js"></script>
        <script type="application/javascript" defer src="_bundle\react-23c48c44d4a3ad02.js"></script>
        <script type="application/javascript" defer src="_bundle\app-ba6364e2395fcb2b.js"></script>
        <script type="application/javascript" defer src="_bundle/mermaid-extension.js"></script>
        
    </body>
</html>