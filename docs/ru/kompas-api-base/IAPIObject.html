<!DOCTYPE html>
<html lang="ru" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <base href="../../" />
        <title>SDK КОМПАС-3D</title>
        <link rel="canonical" href="ru/kompas-api-base/IAPIObject.html">
        <link rel="alternate" href="ru/kompas-api-base/IAPIObject.html" hreflang="ru" />
        <meta name="generator" content="Diplodoc Platform v5.15.6">
        
        <style type="text/css">html, body {min-height:100vh; height:100vh;}</style>
        
        
        <link type="text/css" rel="stylesheet" href="_bundle\vendor-593a6546600e304d.css"/>
        <link type="text/css" rel="stylesheet" href="_bundle\app-78e49b3fc9a05a8f.css"/>
    </head>
    <body class="g-root g-root_theme_light">
        <div id="root"></div>
        <script type="application/json" id="diplodoc-state">
            {"data":{"leading":false,"html":"&lt;h1&gt;&lt;strong&gt;Интерфейс IAPIObject&lt;/strong&gt;&lt;/h1&gt;\n&lt;h2 id=\"ierarhiya-nasledovaniya\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#ierarhiya-nasledovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Иерархия наследования&lt;/span&gt;&lt;/a&gt;Иерархия наследования&lt;/h2&gt;\n&lt;div class=\"mermaid\" data-content=\"graph%20TD%0A%20%20%20%20A%5BIAPIObject%5D%20--%3E%20B%5BIKompasAPIObject%5D%0A%20%20%20%20B%20--%3E%20C%5BIKompasDocument%5D%0A%20%20%20%20C%20--%3E%20D%5BIKompasDocument2D%5D%0A%20%20%20%20B%20--%3E%20E%5BIKompasCollection%5D%0A%20%20%20%20E%20--%3E%20F%5BIDocuments%20%2F%20IViews%20%2F%20%D0%93%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B%5D%0A\"&gt;&lt;/div&gt;&lt;h2 id=\"obshee-opisanie\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#obshee-opisanie\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Общее описание&lt;/span&gt;&lt;/a&gt;Общее описание&lt;/h2&gt;\n&lt;p&gt;Базовый интерфейс для всей системы управления объектами КОМПАС API. Является корневым интерфейсом иерархии, от которого наследуются все остальные интерфейсы через &lt;a href=\"ru/kompas-api-base/IKompasAPIObject.html\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-y4dojnhc\"&gt;IKompasAPIObject&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Основные характеристики:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Корневой интерфейс всей иерархии объектов КОМПАС API&lt;/li&gt;\n&lt;li&gt;Предоставляет базовые механизмы управления временем жизни объектов через подсчет ссылок&lt;/li&gt;\n&lt;li&gt;Реализует паттерн QueryInterface для получения дополнительных интерфейсов&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\"vazhnye-primechaniya\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#vazhnye-primechaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Важные примечания&lt;/span&gt;&lt;/a&gt;Важные примечания&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;Все интерфейсы&lt;/strong&gt; КОМПАС API наследуются от &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-b5hst7h5\"&gt;IAPIObject&lt;/code&gt; → &lt;a href=\"ru/kompas-api-base/IKompasAPIObject.html\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-zqu2nn94\"&gt;IKompasAPIObject&lt;/code&gt;&lt;/a&gt;.&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Управление памятью:&lt;/strong&gt; Методы &lt;a href=\"ru/kompas-api-base/IAPIObject.html#addref\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-lzfm3gys\"&gt;AddRef()&lt;/code&gt;&lt;/a&gt; и &lt;a href=\"ru/kompas-api-base/IAPIObject.html#release\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-65mpmdp4\"&gt;Release()&lt;/code&gt;&lt;/a&gt; реализуют подсчет ссылок. Всегда используйте &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-s7bmtqie\"&gt;Release()&lt;/code&gt; вместо прямого &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-2dibzc8l\"&gt;delete&lt;/code&gt;, если это требуется.&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;QueryInterface:&lt;/strong&gt; Метод &lt;a href=\"ru/kompas-api-base/IAPIObject.html#queryinterface\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-wln5eaqm\"&gt;QueryInterface()&lt;/code&gt;&lt;/a&gt; позволяет получить доступ к дополнительным интерфейсам объекта.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\"poluchenie-interfejsa\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#poluchenie-interfejsa\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Получение интерфейса&lt;/span&gt;&lt;/a&gt;Получение интерфейса&lt;/h2&gt;\n&lt;h3 id=\"osnovnye-sposoby-polucheniya\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#osnovnye-sposoby-polucheniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Основные способы получения:&lt;/span&gt;&lt;/a&gt;Основные способы получения:&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;Через методы существующих объектов:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Через &lt;a href=\"ru/kompas-api-base/IAPIObject.html#queryinterface\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vbtr0b7o\"&gt;QueryInterface()&lt;/code&gt;&lt;/a&gt; от любого объекта&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"primery-polucheniya\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#primery-polucheniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Примеры получения:&lt;/span&gt;&lt;/a&gt;Примеры получения:&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Пример 1: Получение документа&lt;/span&gt;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\nksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Пример 2: Использование SmartPtr для безопасного управления&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;ProcessDocument&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksapi::IKompasDocumentPtr doc)&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=\"hljs-comment\"&gt;// SmartPtr автоматически вызывает AddRef/Release&lt;/span&gt;\n    ksapi::IDocumentFramePtr frame = doc-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetActiveFrame&lt;/span&gt;();\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (frame)\n    {\n        frame-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;RefreshWindow&lt;/span&gt;();\n    }\n}  &lt;span class=\"hljs-comment\"&gt;// frame автоматически освобождается здесь&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"73\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-73\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-73\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-73.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h2 id=\"dopolnitelnye-interfejsy\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#dopolnitelnye-interfejsy\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Дополнительные интерфейсы&lt;/span&gt;&lt;/a&gt;Дополнительные интерфейсы&lt;/h2&gt;\n&lt;p&gt;Интерфейс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-q50lm0jr\"&gt;IAPIObject&lt;/code&gt; является базовым для всей системы. Основные интерфейсы, которые наследуются от него:&lt;/p&gt;\n&lt;h3 id=\"klyuchevye-interfejsy\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#klyuchevye-interfejsy\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Ключевые интерфейсы:&lt;/span&gt;&lt;/a&gt;Ключевые интерфейсы:&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vfxv4tuc\"&gt;IKompasAPIObject&lt;/code&gt;&lt;/strong&gt; - базовый интерфейс объектов КОМПАС (непосредственный потомок)&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-j8aabj2w\"&gt;IKompasApplication&lt;/code&gt;&lt;/strong&gt; - приложение КОМПАС&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-wwwuyv3a\"&gt;IKompasDocument&lt;/code&gt;&lt;/strong&gt; - документ КОМПАС&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-i955qqnb\"&gt;IKompasCollection&lt;/code&gt;&lt;/strong&gt; - коллекции объектов&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\"metody-interfejsa\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#metody-interfejsa\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Методы интерфейса&lt;/span&gt;&lt;/a&gt;Методы интерфейса&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#addref\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-szi1n7y7\"&gt;AddRef()&lt;/code&gt;&lt;/a&gt; - увеличить счетчик ссылок&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#release\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-k8hn7din\"&gt;Release()&lt;/code&gt;&lt;/a&gt; - уменьшить счетчик ссылок и освободить объект&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#queryinterface\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-v7pvak1y\"&gt;QueryInterface()&lt;/code&gt;&lt;/a&gt; - получить интерфейс по UUID&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"addref\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#addref\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;AddRef()&lt;/span&gt;&lt;/a&gt;AddRef()&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Увеличивает счетчик ссылок объекта на 1.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nМетод увеличивает внутренний счетчик ссылок объекта. Вызывается автоматически при копировании &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-47yslct1\"&gt;SmartPtr&lt;/code&gt; или при получении нового указателя на объект. Необходим для правильного управления временем жизни объекта в системе.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;AddRef&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"141\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-141\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-141\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-141.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; void&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#primer-ispolzovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// SmartPtr автоматически вызывает AddRef при копировании&lt;/span&gt;\nksapi::IKompasDocumentPtr doc1 = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;);\nksapi::IKompasDocumentPtr doc2 = doc1;  &lt;span class=\"hljs-comment\"&gt;// AddRef() вызывается автоматически&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"151\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-151\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-151\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-151.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// При ручном управлении (не рекомендуется)&lt;/span&gt;\nksapi::IAPIObject* rawPtr = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\nrawPtr-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddRef&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Увеличиваем счетчик&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// ... использование объекта ...&lt;/span&gt;\nrawPtr-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Освобождаем&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"155\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-155\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-155\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-155.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Обычно не вызывается напрямую - используется &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-5kl3pvcw\"&gt;SmartPtr&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Всегда должен быть парным вызов &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-hc26fvvf\"&gt;Release()&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Увеличивает счетчик на 1&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"release\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#release\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Release()&lt;/span&gt;&lt;/a&gt;Release()&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Уменьшает счетчик ссылок объекта и освобождает его, если счетчик стал равен 0.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nМетод уменьшает внутренний счетчик ссылок объекта на 1. Если счетчик становится равным нулю, объект автоматически освобождает память. Является основным механизмом освобождения ресурсов в системе.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;Release&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"192\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-192\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-192\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-192.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; void&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya1\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#primer-ispolzovaniya1\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// SmartPtr автоматически вызывает Release при уничтожении&lt;/span&gt;\n{\n    ksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;);\n    &lt;span class=\"hljs-comment\"&gt;// Работа с документом&lt;/span&gt;\n}  &lt;span class=\"hljs-comment\"&gt;// doc выходит из области видимости - Release() вызывается автоматически&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"202\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-202\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-202\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-202.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// При ручном управлении (не рекомендуется)&lt;/span&gt;\nksapi::IAPIObject* rawPtr = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\n&lt;span class=\"hljs-comment\"&gt;// ... использование объекта ...&lt;/span&gt;\nrawPtr-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Освобождаем объект&lt;/span&gt;\nrawPtr = &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;;   &lt;span class=\"hljs-comment\"&gt;// Обнуляем указатель&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"206\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-206\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-206\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-206.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;Всегда используйте SmartPtr&lt;/strong&gt; вместо ручного вызова Release()&lt;/li&gt;\n&lt;li&gt;Никогда не вызывайте &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-lx4e1cq4\"&gt;delete&lt;/code&gt; для объектов API&lt;/li&gt;\n&lt;li&gt;После вызова Release() указатель становится невалидным&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"queryinterface\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#queryinterface\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;QueryInterface()&lt;/span&gt;&lt;/a&gt;QueryInterface()&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#группа-1-управление-временем-жизни\"&gt;Группа методов&lt;/a&gt; | &lt;a href=\"ru/kompas-api-base/IAPIObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Возвращает указатель на запрошенный интерфейс или nullptr, если интерфейс не поддерживается.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nМетод является основным механизмом получения дополнительных интерфейсов от объекта. Принимает UUID интерфейса (&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vd40wkab\"&gt;IAPIObjectIID&lt;/code&gt;) и возвращает указатель на базовый класс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-e27yzlh3\"&gt;IAPIObject&lt;/code&gt;, если объект поддерживает запрошенный интерфейс.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; IAPIObject * &lt;span class=\"hljs-title\"&gt;QueryInterface&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(IAPIObjectIID id)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"243\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-243\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-243\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-243.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-7scfapk5\"&gt;id&lt;/code&gt; (in) - UUID запрашиваемого интерфейса&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; Указатель &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-icv1ro8b\"&gt;IAPIObject*&lt;/code&gt; на объект или &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-fyyt75yo\"&gt;nullptr&lt;/code&gt;, если интерфейс не поддерживается.&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya2\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#primer-ispolzovaniya2\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Получение базового интерфейса&lt;/span&gt;\nksapi::IAPIObject* basePtr = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IAPIObject);\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (basePtr)\n{\n    basePtr-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"263\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-263\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-263\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-263.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Source/MyConverter/KompasConverter.cpp (строки 43-48)&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// Реализация QueryInterface в классе конвертера&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IAPIObject * &lt;span class=\"hljs-title\"&gt;KompasConverter::QueryInterface&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksapi::IAPIObjectIID iid)&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=\"hljs-comment\"&gt;// Проверяем поддерживаемые интерфейсы&lt;/span&gt;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (iid == ksapi::IID_IAPIObject || iid == ksapi::IID_ILibraryObject || iid == ksapi::IID_ILibraryConverter)\n        &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;this&lt;/span&gt;;  &lt;span class=\"hljs-comment\"&gt;// Возвращаем указатель на себя&lt;/span&gt;\n    &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;;   &lt;span class=\"hljs-comment\"&gt;// Интерфейс не поддерживается&lt;/span&gt;\n}\n\n&lt;span class=\"hljs-comment\"&gt;// Использование QueryInterface&lt;/span&gt;\nksapi::IAPIObject* base = converter-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_ILibraryConverter);\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (base)\n{\n    ksapi::ILibraryConverterPtr libConv = base;  &lt;span class=\"hljs-comment\"&gt;// Приведение типа&lt;/span&gt;\n    &lt;span class=\"hljs-comment\"&gt;// Работа с интерфейсом&lt;/span&gt;\n    libConv-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"267\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-267\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-267\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-267.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Возвращает &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vsyatn6l\"&gt;nullptr&lt;/code&gt;, если интерфейс не поддерживается&lt;/li&gt;\n&lt;li&gt;При успехе &lt;strong&gt;не увеличивает&lt;/strong&gt; счетчик ссылок&lt;/li&gt;\n&lt;li&gt;Всегда вызывайте &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-q4029d49\"&gt;Release()&lt;/code&gt; на возвращенном указателе после использования&lt;/li&gt;\n&lt;li&gt;Рекомендуется использовать &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-otgfkp8o\"&gt;SmartPtr&lt;/code&gt; для автоматического управления&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"chastye-oshibki\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#chastye-oshibki\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Частые ошибки&lt;/span&gt;&lt;/a&gt;Частые ошибки&lt;/h2&gt;\n&lt;h3 id=\"1-ruchnoe-udalenie-obuekta-vmesto-release\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#1-ruchnoe-udalenie-obuekta-vmesto-release\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;1. Ручное удаление объекта вместо Release()&lt;/span&gt;&lt;/a&gt;1. &lt;strong&gt;Ручное удаление объекта вместо Release()&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;);\n&lt;span class=\"hljs-comment\"&gt;// ... работа ...&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;delete&lt;/span&gt; doc;  &lt;span class=\"hljs-comment\"&gt;// Не рекомендуется!&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;);\n&lt;span class=\"hljs-comment\"&gt;// ... работа ...&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// doc автоматически освобождается при выходе из области видимости&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"300\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-300\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-300\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-300.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"2-utechka-pamyati-iz-za-otsutstviya-release\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#2-utechka-pamyati-iz-za-otsutstviya-release\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;2. Утечка памяти из-за отсутствия Release()&lt;/span&gt;&lt;/a&gt;2. &lt;strong&gt;Утечка памяти из-за отсутствия Release()&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nksapi::IAPIObject* rawPtr = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\n&lt;span class=\"hljs-comment\"&gt;// ... работа ...&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// Забыли вызвать Release() - утечка памяти!&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nksapi::IAPIObject* rawPtr = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (rawPtr)\n{\n    &lt;span class=\"hljs-comment\"&gt;// ... работа ...&lt;/span&gt;\n    rawPtr-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"304\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-304\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-304\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-304.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"3-ispolzovanie-osvobozhdennogo-obuekta\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#3-ispolzovanie-osvobozhdennogo-obuekta\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;3. Использование освобожденного объекта&lt;/span&gt;&lt;/a&gt;3. &lt;strong&gt;Использование освобожденного объекта&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;);\ndoc-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Преждевременное освобождение&lt;/span&gt;\ndoc-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Save&lt;/span&gt;();     &lt;span class=\"hljs-comment\"&gt;// Краш! Объект уже освобожден&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;);\ndoc-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Save&lt;/span&gt;();     &lt;span class=\"hljs-comment\"&gt;// Используем объект&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// doc автоматически освобождается при выходе из области видимости&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"308\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-308\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-308\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-308.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"4-poterya-ukazatelya-pri-mnozhestvennyh-privedeniyah\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#4-poterya-ukazatelya-pri-mnozhestvennyh-privedeniyah\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;4. Потеря указателя при множественных приведениях&lt;/span&gt;&lt;/a&gt;4. &lt;strong&gt;Потеря указателя при множественных приведениях&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nksapi::IAPIObject* base1 = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\nksapi::IAPIObject* base2 = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\n&lt;span class=\"hljs-comment\"&gt;// Два разных объекта! Каждый требует отдельного Release()&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nksapi::IAPIObject* base = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (base)\n{\n    ksapi::IKompasAPIObjectPtr kompasObj = base;  &lt;span class=\"hljs-comment\"&gt;// Один указатель&lt;/span&gt;\n    &lt;span class=\"hljs-comment\"&gt;// ... работа ...&lt;/span&gt;\n    base-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Освобождаем один раз&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"312\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-312\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-312\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-312.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"prakticheskie-primery-iz-ishodnikov\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#prakticheskie-primery-iz-ishodnikov\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Практические примеры из исходников&lt;/span&gt;&lt;/a&gt;Практические примеры из исходников&lt;/h2&gt;\n&lt;h3 id=\"primer-1-realizaciya-queryinterface-v-klasse-biblioteki\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#primer-1-realizaciya-queryinterface-v-klasse-biblioteki\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример 1: Реализация QueryInterface в классе библиотеки&lt;/span&gt;&lt;/a&gt;Пример 1: Реализация QueryInterface в классе библиотеки&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Source/MyConverter/KompasConverter.cpp (строки 43-48)&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IAPIObject * &lt;span class=\"hljs-title\"&gt;KompasConverter::QueryInterface&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksapi::IAPIObjectIID iid)&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=\"hljs-comment\"&gt;// Проверяем поддерживаемые интерфейсы&lt;/span&gt;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (iid == ksapi::IID_IAPIObject ||\n        iid == ksapi::IID_ILibraryObject ||\n        iid == ksapi::IID_ILibraryConverter)\n        &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; &lt;span class=\"hljs-keyword\"&gt;this&lt;/span&gt;;  &lt;span class=\"hljs-comment\"&gt;// Возвращаем себя с увеличенным счетчиком ссылок&lt;/span&gt;\n    &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;;   &lt;span class=\"hljs-comment\"&gt;// Интерфейс не поддерживается&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"320\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-320\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-320\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-320.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"primer-2-bezopasnoe-ispolzovanie-smartptr\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#primer-2-bezopasnoe-ispolzovanie-smartptr\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример 2: Безопасное использование SmartPtr&lt;/span&gt;&lt;/a&gt;Пример 2: Безопасное использование SmartPtr&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Безопасная работа с документами&lt;/span&gt;\nksapi::IKompasApplicationPtr kompasApp = ...;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\n\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)\n{\n    ksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(i);\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Работа с документом&lt;/span&gt;\n        doc-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Save&lt;/span&gt;();\n    }\n    &lt;span class=\"hljs-comment\"&gt;// doc автоматически освобождается в каждой итерации&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"324\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-324\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-324\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-324.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"shablony-ispolzovaniya\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#shablony-ispolzovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблоны использования&lt;/span&gt;&lt;/a&gt;Шаблоны использования&lt;/h2&gt;\n&lt;h3 id=\"shablon-1-bezopasnoe-poluchenie-interfejsa\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#shablon-1-bezopasnoe-poluchenie-interfejsa\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблон 1: Безопасное получение интерфейса&lt;/span&gt;&lt;/a&gt;Шаблон 1: Безопасное получение интерфейса&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Описание: Безопасное получение интерфейса через QueryInterface&lt;/span&gt;\nksapi::IAPIObject* base = obj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_ILibraryConverter);\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (base)\n{\n    ksapi::ILibraryConverterPtr converter = base;\n    &lt;span class=\"hljs-comment\"&gt;// Использование интерфейса&lt;/span&gt;\n    base-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();  &lt;span class=\"hljs-comment\"&gt;// Освобождаем&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"332\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-332\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-332\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-332.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"shablon-2-proverka-tipa-obuekta\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#shablon-2-proverka-tipa-obuekta\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблон 2: Проверка типа объекта&lt;/span&gt;&lt;/a&gt;Шаблон 2: Проверка типа объекта&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Описание: Проверка поддержки интерфейса перед использованием&lt;/span&gt;\nksapi::IAPIObject* base = unknownObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;QueryInterface&lt;/span&gt;(IID_IKompasAPIObject);\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (base)\n{\n    &lt;span class=\"hljs-comment\"&gt;// Объект поддерживает IKompasAPIObject&lt;/span&gt;\n    ksapi::IKompasAPIObjectPtr kompasObj = base;\n    &lt;span class=\"hljs-keyword\"&gt;auto&lt;/span&gt; type = kompasObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetType&lt;/span&gt;();\n    base-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Release&lt;/span&gt;();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"336\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-336\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-336\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-336.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"shablon-3-iteraciya-po-kollekcii-s-bezopasnym-upravleniem\"&gt;&lt;a href=\"ru/kompas-api-base/IAPIObject.html#shablon-3-iteraciya-po-kollekcii-s-bezopasnym-upravleniem\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблон 3: Итерация по коллекции с безопасным управлением&lt;/span&gt;&lt;/a&gt;Шаблон 3: Итерация по коллекции с безопасным управлением&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Описание: Итерация с автоматическим освобождением объектов&lt;/span&gt;\nksapi::IDocumentsPtr documents = kompasApp-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocuments&lt;/span&gt;();\n&lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;(); i++)\n{\n    ksapi::IKompasDocumentPtr doc = documents-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetDocument&lt;/span&gt;(i);\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Работа с документом&lt;/span&gt;\n        &lt;span class=\"hljs-comment\"&gt;// doc освобождается автоматически в конце итерации&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"340\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-340\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-340\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-340.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n","meta":{"metadata":[{"name":"generator","content":"Diplodoc Platform v5.15.6"}],"alternate":[{"href":"ru/kompas-api-base/IAPIObject.html","hreflang":"ru"}],"script":["_bundle/mermaid-extension.js"],"canonical":"ru/kompas-api-base/IAPIObject.html","vcsPath":"ru/kompas-api-base/IAPIObject.md"},"headings":[{"title":"Иерархия наследования","href":"ru/kompas-api-base/IAPIObject.html#ierarhiya-nasledovaniya","level":2},{"title":"Общее описание","href":"ru/kompas-api-base/IAPIObject.html#obshee-opisanie","level":2},{"title":"Важные примечания","href":"ru/kompas-api-base/IAPIObject.html#vazhnye-primechaniya","level":2},{"title":"Получение интерфейса","href":"ru/kompas-api-base/IAPIObject.html#poluchenie-interfejsa","level":2,"items":[{"title":"Основные способы получения:","href":"ru/kompas-api-base/IAPIObject.html#osnovnye-sposoby-polucheniya","level":3},{"title":"Примеры получения:","href":"ru/kompas-api-base/IAPIObject.html#primery-polucheniya","level":3}]},{"title":"Дополнительные интерфейсы","href":"ru/kompas-api-base/IAPIObject.html#dopolnitelnye-interfejsy","level":2,"items":[{"title":"Ключевые интерфейсы:","href":"ru/kompas-api-base/IAPIObject.html#klyuchevye-interfejsy","level":3}]},{"title":"Методы интерфейса","href":"ru/kompas-api-base/IAPIObject.html#metody-interfejsa","level":2,"items":[{"title":"AddRef()","href":"ru/kompas-api-base/IAPIObject.html#addref","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-base/IAPIObject.html#primer-ispolzovaniya","level":4}]},{"title":"Release()","href":"ru/kompas-api-base/IAPIObject.html#release","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-base/IAPIObject.html#primer-ispolzovaniya1","level":4}]},{"title":"QueryInterface()","href":"ru/kompas-api-base/IAPIObject.html#queryinterface","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-base/IAPIObject.html#primer-ispolzovaniya2","level":4}]}]},{"title":"Частые ошибки","href":"ru/kompas-api-base/IAPIObject.html#chastye-oshibki","level":2,"items":[{"title":"1. Ручное удаление объекта вместо Release()","href":"ru/kompas-api-base/IAPIObject.html#1-ruchnoe-udalenie-obuekta-vmesto-release","level":3},{"title":"2. Утечка памяти из-за отсутствия Release()","href":"ru/kompas-api-base/IAPIObject.html#2-utechka-pamyati-iz-za-otsutstviya-release","level":3},{"title":"3. Использование освобожденного объекта","href":"ru/kompas-api-base/IAPIObject.html#3-ispolzovanie-osvobozhdennogo-obuekta","level":3},{"title":"4. Потеря указателя при множественных приведениях","href":"ru/kompas-api-base/IAPIObject.html#4-poterya-ukazatelya-pri-mnozhestvennyh-privedeniyah","level":3}]},{"title":"Практические примеры из исходников","href":"ru/kompas-api-base/IAPIObject.html#prakticheskie-primery-iz-ishodnikov","level":2,"items":[{"title":"Пример 1: Реализация QueryInterface в классе библиотеки","href":"ru/kompas-api-base/IAPIObject.html#primer-1-realizaciya-queryinterface-v-klasse-biblioteki","level":3},{"title":"Пример 2: Безопасное использование SmartPtr","href":"ru/kompas-api-base/IAPIObject.html#primer-2-bezopasnoe-ispolzovanie-smartptr","level":3}]},{"title":"Шаблоны использования","href":"ru/kompas-api-base/IAPIObject.html#shablony-ispolzovaniya","level":2,"items":[{"title":"Шаблон 1: Безопасное получение интерфейса","href":"ru/kompas-api-base/IAPIObject.html#shablon-1-bezopasnoe-poluchenie-interfejsa","level":3},{"title":"Шаблон 2: Проверка типа объекта","href":"ru/kompas-api-base/IAPIObject.html#shablon-2-proverka-tipa-obuekta","level":3},{"title":"Шаблон 3: Итерация по коллекции с безопасным управлением","href":"ru/kompas-api-base/IAPIObject.html#shablon-3-iteraciya-po-kollekcii-s-bezopasnym-upravleniem","level":3}]}],"title":""},"router":{"pathname":"ru/kompas-api-base/IAPIObject","depth":3,"base":"../../"},"lang":"ru","langs":["ru"],"viewerInterface":{"toc":true,"search":true,"feedback":true}}
        </script>
        <script type="application/javascript">
            const data = document.querySelector('script#diplodoc-state');
            window.__DATA__ = JSON.parse((function unescape(string) {
                return string.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&");
              })(data.innerText));
            window.STATIC_CONTENT = false;
        </script>
        <script type="application/javascript" defer src="ru/toc.js"></script>
        <script type="application/javascript" defer src="_bundle\vendor-cc74e4dafed769a9.js"></script>
        <script type="application/javascript" defer src="_bundle\react-23c48c44d4a3ad02.js"></script>
        <script type="application/javascript" defer src="_bundle\app-ba6364e2395fcb2b.js"></script>
        <script type="application/javascript" defer src="_bundle/mermaid-extension.js"></script>
        
    </body>
</html>