<!DOCTYPE html>
<html lang="ru" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <base href="../../../../../../../" />
        <title><strong>Интерфейс IMacroObject</strong> | SDK КОМПАС-3D</title>
        <link rel="canonical" href="ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html">
        <link rel="alternate" href="ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html" hreflang="ru" />
        <meta name="generator" content="Diplodoc Platform v5.15.6">
        
        <style type="text/css">html, body {min-height:100vh; height:100vh;}</style>
        
        
        <link type="text/css" rel="stylesheet" href="_bundle\vendor-593a6546600e304d.css"/>
        <link type="text/css" rel="stylesheet" href="_bundle\app-78e49b3fc9a05a8f.css"/>
    </head>
    <body class="g-root g-root_theme_light">
        <div id="root"></div>
        <script type="application/json" id="diplodoc-state">
            {"data":{"leading":false,"html":"&lt;h2 id=\"ierarhiya-nasledovaniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#ierarhiya-nasledovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Иерархия наследования&lt;/span&gt;&lt;/a&gt;Иерархия наследования&lt;/h2&gt;\n&lt;style&gt;.top-parent {\n  color: #ffe3d8;\n  background: green;\n  border: 3px solid #046709;\n  border-radius: 4px;\n  padding: 5px;\n  text-align: center;\n  margin-bottom: 5px;\n  font-weight: bold;\n  width: 40%;\n  max-width: 220px;\n}\n\n.other-parents {\n  color: #ffe3d8;\n  background: #4a6fa5;\n  border: 3px solid #3d5b87;\n  border-radius: 4px;\n  padding: 5px;\n  text-align: center;\n  margin: 5px 10%;\n  font-weight: bold;\n  width: 40%;\n  max-width: 220px;\n}\n\n.interface {\n  color: #ffe3d8;\n  background: #103874;\n  border: 3px solid #002152;\n  border-radius: 4px;\n  padding: 5px;\n  text-align: center;\n  margin: 5px 10%;\n  font-weight: bold;\n  width: 40%;\n  max-width: 220px;\n}&lt;/style&gt;\n&lt;div style=\"padding:10px;background:#f5f5f5;border-radius:5px;max-width:auto;margin-bottom:20px\"&gt;\n&lt;div class=\"top-parent\"&gt;IAPIObject&lt;/div&gt;\n&lt;div style=\"text-align:left;color:black;margin:5px 15%\"&gt;▼&lt;/div&gt;\n&lt;div class=\"other-parents\"&gt;IKompasAPIObject&lt;/div&gt;\n&lt;div style=\"text-align:left;color:black;margin:5px 25%\"&gt;▼&lt;/div&gt;\n\n&lt;div class=\"other-parents\" style=\"margin:5px 20%\"&gt;IDrawingObject&lt;/div&gt;\n\n&lt;div style=\"text-align:left;color:black;margin:5px 35%\"&gt;▼&lt;/div&gt;\n\n&lt;div class=\"interface\" style=\"margin:5px 30%\"&gt;IMacroObject&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"mermaid\" data-content=\"graph%20TD%0A%20%20%20%20A%5BIAPIObject%5D%20--%3E%20B%5BIKompasAPIObject%5D%0A%20%20%20%20B%20--%3E%20C%5BIDrawingObject%5D%0A%20%20%20%20C%20--%3E%20D%5BIMacroObject%5D%0A\"&gt;&lt;/div&gt;&lt;h2 id=\"obshee-opisanie\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#obshee-opisanie\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Общее описание&lt;/span&gt;&lt;/a&gt;Общее описание&lt;/h2&gt;\n&lt;p&gt;Интерфейс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-z4lu0u77\"&gt;IMacroObject&lt;/code&gt; предоставляет методы для работы с макроэлементами в системе КОМПАС-3D. Макрообъекты представляют собой составные графические элементы, которые могут содержать другие объекты чертежа (отрезки, окружности, дуги и т.д.) и обладают собственными параметрами размещения, редактирования и управления.&lt;/p&gt;\n&lt;h2 id=\"vazhnye-primechaniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#vazhnye-primechaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Важные примечания&lt;/span&gt;&lt;/a&gt;Важные примечания&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;После изменения параметров макрообъекта &lt;strong&gt;всегда необходимо вызывать метод &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-d3o7uy76\"&gt;Update()&lt;/code&gt;&lt;/strong&gt;, унаследованный от &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-6pvh9he1\"&gt;IDrawingObject&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;Для любого объекта, унаследованного от &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-j55gcjca\"&gt;IDrawingObject&lt;/code&gt;, требуется вызов &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-lmqgqx8p\"&gt;Update()&lt;/code&gt; после модификации.&lt;/li&gt;\n&lt;li&gt;Получение дополнительных интерфейсов осуществляется через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-3hask7os\"&gt;SmartPtr&amp;lt;Interface&amp;gt;&lt;/code&gt;, который автоматически вызывает &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-umc2vie3\"&gt;QueryInterface&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;Макрообъекты могут содержать различные типы объектов: графические примитивы, слои, виды, группы и другие макрообъекты.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\"poluchenie-interfejsa\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#poluchenie-interfejsa\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Получение интерфейса&lt;/span&gt;&lt;/a&gt;Получение интерфейса&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Из коллекции макроэлементов:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-2dvp2y8d\"&gt;IMacroObjects::Add&lt;/code&gt; - создание нового макрообъекта&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-1483cxlm\"&gt;IMacroObjects::GetMacroObject&lt;/code&gt; - получение по индексу&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-n0wvzk1r\"&gt;IMacroObjects::GetMacroObjectByName&lt;/code&gt; - получение по имени&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Из документа:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-z1p8c4s0\"&gt;IKompasDocument2D::GetEditMacroObject&lt;/code&gt; - получение редактируемого макрообъекта&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-rzthoinb\"&gt;IKompasDocument3D::GetLibraryEditObject&lt;/code&gt; - получение редактируемого макрообъекта из библиотеки&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Приведение типов:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-z25uald3\"&gt;SmartPtr&amp;lt;Interface&amp;gt;&lt;/code&gt; от дополнительных интерфейсов&lt;/li&gt;\n&lt;li&gt;Автоматическое приведение от базовых интерфейсов&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\"dopolnitelnye-interfejsy\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#dopolnitelnye-interfejsy\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Дополнительные интерфейсы&lt;/span&gt;&lt;/a&gt;Дополнительные интерфейсы&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/IDrawingContainer.html\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-nfdpb9ff\"&gt;IDrawingContainer&lt;/code&gt;&lt;/a&gt; - интерфейс контейнера объектов вида графического документа&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-9abliev9\"&gt;IBuildingContainer&lt;/code&gt; - интерфейс контейнера объектов СПДС&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-l8bwj70u\"&gt;ISymbols2DContainer&lt;/code&gt; - интерфейс контейнера условных обозначений&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-1a8657cr\"&gt;IAnnotativeContainer&lt;/code&gt; - интерфейс контейнера аннотационных объектов&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-17nuqoel\"&gt;IPropertyKeeper&lt;/code&gt; - интерфейс получения/редактирования значения свойств&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-msmy9z3c\"&gt;IFeature&lt;/code&gt; - интерфейс объекта-характеристики (для работы с подчиненными объектами)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\"metody-interfejsa\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#metody-interfejsa\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Методы интерфейса&lt;/span&gt;&lt;/a&gt;Методы интерфейса&lt;/h2&gt;\n&lt;h3 id=\"gruppa-1-osnovnye-parametry-i-razmeshenie\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-1-osnovnye-parametry-i-razmeshenie\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Группа 1: Основные параметры и размещение&lt;/span&gt;&lt;/a&gt;Группа 1: Основные параметры и размещение&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getplacement--setplacement\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-lp4nmxn1\"&gt;GetPlacement()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-wx24lk1m\"&gt;SetPlacement()&lt;/code&gt;&lt;/a&gt; - получение и установка параметров размещения&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setname--getname\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-8aa62dx4\"&gt;SetName()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ubtzkhgo\"&gt;GetName()&lt;/code&gt;&lt;/a&gt; - управление именем макрообъекта&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getlabel\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-fhcyet5l\"&gt;GetLabel()&lt;/code&gt;&lt;/a&gt; - получение отображаемого имени в дереве&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"gruppa-2-upravlenie-soderzhimym\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-2-upravlenie-soderzhimym\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Группа 2: Управление содержимым&lt;/span&gt;&lt;/a&gt;Группа 2: Управление содержимым&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#addobjects--setobjects\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ezz3nto5\"&gt;AddObjects()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-wczk9tq8\"&gt;SetObjects()&lt;/code&gt;&lt;/a&gt; - добавление и установка объектов&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#findobject\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-u2pcotfn\"&gt;FindObject()&lt;/code&gt;&lt;/a&gt; - поиск объекта в макроэлементе&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"gruppa-3-flagi-redaktirovaniya-i-specialnye-flagi\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-3-flagi-redaktirovaniya-i-specialnye-flagi\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Группа 3: Флаги редактирования и специальные флаги&lt;/span&gt;&lt;/a&gt;Группа 3: Флаги редактирования и специальные флаги&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setdoubleclickeditable--isdoubleclickeditable\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-pa7ue382\"&gt;SetDoubleClickEditable()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ssi3f2l5\"&gt;IsDoubleClickEditable()&lt;/code&gt;&lt;/a&gt; - редактирование двойным щелчком&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#sethotpointseditable--ishotpointseditable\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-8aytv24q\"&gt;SetHotPointsEditable()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-e7w6kbmg\"&gt;IsHotPointsEditable()&lt;/code&gt;&lt;/a&gt; - редактирование характерными точками&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setexternaleditable--isexternaleditable\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-w506df1i\"&gt;SetExternalEditable()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-3uadgl0b\"&gt;IsExternalEditable()&lt;/code&gt;&lt;/a&gt; - внешнее управление&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setpropertyobjecteditable--ispropertyobjecteditable\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-el3go0ip\"&gt;SetPropertyObjectEditable()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-yiuutrnm\"&gt;IsPropertyObjectEditable()&lt;/code&gt;&lt;/a&gt; - внешние свойства&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setcreatespcobjects--iscreatespcobjects\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-9ddawlnk\"&gt;SetCreateSpcObjects()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-zz0r84to\"&gt;IsCreateSpcObjects()&lt;/code&gt;&lt;/a&gt; - создание объектов спецификации&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setbreakobjectsenabled--isbreakobjectsenabled\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-a95as91p\"&gt;SetBreakObjectsEnabled()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-lz7g5vya\"&gt;IsBreakObjectsEnabled()&lt;/code&gt;&lt;/a&gt; - учет разрыва вида&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"gruppa-4-harakternye-tochki\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-4-harakternye-tochki\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Группа 4: Характерные точки&lt;/span&gt;&lt;/a&gt;Группа 4: Характерные точки&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#adddefaulthotpoint--deletedefaulthotpoint\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vkbhmq44\"&gt;AddDefaultHotPoint()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-oxy0wug3\"&gt;DeleteDefaultHotPoint()&lt;/code&gt;&lt;/a&gt; - управление характерными точками&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"gruppa-5-prisoedinennye-vynoski\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-5-prisoedinennye-vynoski\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Группа 5: Присоединенные выноски&lt;/span&gt;&lt;/a&gt;Группа 5: Присоединенные выноски&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getattachedleaders--deleteattachedleaders\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-mer7f32h\"&gt;GetAttachedLeaders()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-hxietqm9\"&gt;DeleteAttachedLeaders()&lt;/code&gt;&lt;/a&gt; - работа с линиями-выносками&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\"gruppa-6-preobrazovanie-koordinat\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-6-preobrazovanie-koordinat\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Группа 6: Преобразование координат&lt;/span&gt;&lt;/a&gt;Группа 6: Преобразование координат&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#transformpointtoview--transformpointfromview\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-zkc44jp0\"&gt;TransformPointToView()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-94ele4k4\"&gt;TransformPointFromView()&lt;/code&gt;&lt;/a&gt; - преобразование координат точки&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#transformangletoview--transformanglefromview\"&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-qyyzp7qx\"&gt;TransformAngleToView()&lt;/code&gt; / &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-yz135zdd\"&gt;TransformAngleFromView()&lt;/code&gt;&lt;/a&gt; - преобразование углов&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"getplacement-/-setplacement\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getplacement-/-setplacement\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;GetPlacement / SetPlacement&lt;/span&gt;&lt;/a&gt;GetPlacement / SetPlacement&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-1-основные-параметры-и-размещение\"&gt;Основные параметры и размещение&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Получение и установка параметров размещения макрообъекта в системе координат вида.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nМетоды позволяют работать с геометрическим положением макрообъекта. &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-7qsglqqe\"&gt;GetPlacement&lt;/code&gt; возвращает текущие параметры размещения, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-4lq212uu\"&gt;SetPlacement&lt;/code&gt; устанавливает новые. Размещение включает координаты точки привязки, угол поворота и признак зеркального отражения.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;GetPlacement&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; x, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; y, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; angle, &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &amp;amp; mirrorSymmetry)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetPlacement&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; X, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; Y, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; Angle, &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirrorSymmetry, &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; relative)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"265\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-265\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-265\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-265.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры GetPlacement:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-gvzw0hob\"&gt;x&lt;/code&gt; (out) - координата X точки привязки&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-56axtmfh\"&gt;y&lt;/code&gt; (out) - координата Y точки привязки&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-upna9dp1\"&gt;angle&lt;/code&gt; (out) - угол поворота в градусах (0-360)&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-tzhdjlot\"&gt;mirrorSymmetry&lt;/code&gt; (out) - признак зеркального отражения&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetPlacement:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-dcljyvdn\"&gt;X&lt;/code&gt; (in) - новая координата X точки привязки&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ka5spvru\"&gt;Y&lt;/code&gt; (in) - новая координата Y точки привязки&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-q01o4yrz\"&gt;Angle&lt;/code&gt; (in) - новый угол поворота в градусах&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-anj6wcnq\"&gt;mirrorSymmetry&lt;/code&gt; (in) - новый признак зеркального отражения&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ku90jjkd\"&gt;relative&lt;/code&gt; (in) - признак относительного изменения координат&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-fj3oztbk\"&gt;true&lt;/code&gt; - операция выполнена успешно, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-zg6lmzdu\"&gt;false&lt;/code&gt; - произошла ошибка&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x, y, angle;\n&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirror;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPlacement&lt;/span&gt;(x, y, angle, mirror);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPlacement&lt;/span&gt;(x + &lt;span class=\"hljs-number\"&gt;10&lt;/span&gt;, y + &lt;span class=\"hljs-number\"&gt;10&lt;/span&gt;, angle + &lt;span class=\"hljs-number\"&gt;15&lt;/span&gt;, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"330\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-330\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-330\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-330.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Получение и изменение параметров размещения макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject &amp;amp;&amp;amp; macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsValid&lt;/span&gt;())\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Получаем текущие параметры размещения&lt;/span&gt;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;, y = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;, angle = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n        &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirror = &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPlacement&lt;/span&gt;(x, y, angle, mirror);\n\n        &lt;span class=\"hljs-comment\"&gt;// Изменяем параметры размещения&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPlacement&lt;/span&gt;(x + &lt;span class=\"hljs-number\"&gt;10&lt;/span&gt;, y + &lt;span class=\"hljs-number\"&gt;10&lt;/span&gt;, angle + &lt;span class=\"hljs-number\"&gt;15&lt;/span&gt;, !mirror, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;);\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"334\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-334\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-334\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-334.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;После вызова &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-b9p1kgy8\"&gt;SetPlacement()&lt;/code&gt; всегда необходимо вызывать &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-w987991e\"&gt;Update()&lt;/code&gt; для применения изменений&lt;/li&gt;\n&lt;li&gt;При &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-gryps7br\"&gt;relative = true&lt;/code&gt; новые координаты прибавляются к текущим, при &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-zlvxggox\"&gt;false&lt;/code&gt; - заменяют их&lt;/li&gt;\n&lt;li&gt;Угол поворота задается в градусах, положительное направление - против часовой стрелки&lt;/li&gt;\n&lt;li&gt;Зеркальное отражение применяется относительно вертикальной оси макрообъекта&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"setname-/-getname\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setname-/-getname\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;SetName / GetName&lt;/span&gt;&lt;/a&gt;SetName / GetName&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-1-основные-параметры-и-размещение\"&gt;Основные параметры и размещение&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Установка и получение имени макрообъекта в дереве чертежа.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nИмя макрообъекта используется для идентификации в дереве документа КОМПАС-3D. Метод &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-kiah033r\"&gt;SetName()&lt;/code&gt; задает имя, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vd2nc7wk\"&gt;GetName()&lt;/code&gt; возвращает текущее имя. Имя может использоваться для поиска макрообъекта через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-d85201ik\"&gt;GetMacroObjectByName()&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetName&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; std::wstring &amp;amp; name)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; std::wstring &lt;span class=\"hljs-title\"&gt;GetName&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"376\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-376\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-376\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-376.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetName:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-tfpooc6c\"&gt;name&lt;/code&gt; (in) - новое имя макрообъекта (строка Unicode)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение GetName:&lt;/strong&gt; Текущее имя макрообъекта в виде строки &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-65wpwd62\"&gt;std::wstring&lt;/code&gt;&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya1\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya1\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Установка имени&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Мой макрообъект\"&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Получение имени&lt;/span&gt;\nstd::wstring name = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetName&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"396\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-396\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-396\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-396.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Работа с именем макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Устанавливаем имя&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Отверстие_1\"&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Получаем имя&lt;/span&gt;\n        std::wstring name = macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetName&lt;/span&gt;();\n        std::wstring label = macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLabel&lt;/span&gt;();\n\n        &lt;span class=\"hljs-comment\"&gt;// Поиск макрообъекта по имени в коллекции&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObjectsPtr &lt;span class=\"hljs-title\"&gt;macroObjects&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetMacroObjects())&lt;/span&gt;&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObjects)\n        {\n            &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;foundMacro&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(macroObjects-&amp;gt;GetMacroObjectByName(&lt;span class=\"hljs-string\"&gt;L\"Отверстие_1\"&lt;/span&gt;))&lt;/span&gt;&lt;/span&gt;;\n            &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (foundMacro)\n            {\n                &lt;span class=\"hljs-comment\"&gt;// Макрообъект найден&lt;/span&gt;\n            }\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"400\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-400\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-400\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-400.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Имя макрообъекта не обязано быть уникальным в коллекции&lt;/li&gt;\n&lt;li&gt;При поиске через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-94jarxw2\"&gt;GetMacroObjectByName()&lt;/code&gt; возвращается первый макрообъект с совпадающим именем&lt;/li&gt;\n&lt;li&gt;Имя может содержать любые Unicode-символы, включая пробелы и специальные символы&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"getlabel\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getlabel\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;GetLabel&lt;/span&gt;&lt;/a&gt;GetLabel&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-1-основные-параметры-и-размещение\"&gt;Основные параметры и размещение&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Получение отображаемого имени объекта в дереве документа.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nВозвращает имя, которое отображается для пользователя в дереве документа КОМПАС-3D. В отличие от &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-3v5sup5v\"&gt;GetName()&lt;/code&gt;, которое возвращает внутреннее имя, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-f23lbca1\"&gt;GetLabel()&lt;/code&gt; может возвращать локализованное или форматированное имя для отображения в интерфейсе.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; std::wstring &lt;span class=\"hljs-title\"&gt;GetLabel&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"437\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-437\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-437\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-437.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; Отображаемое имя макрообъекта в виде строки &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-lc53e8e8\"&gt;std::wstring&lt;/code&gt;&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya2\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya2\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;std::wstring displayName = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLabel&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"447\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-447\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-447\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-447.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Получение отображаемого и внутреннего имени&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        std::wstring label = macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLabel&lt;/span&gt;();\n        std::wstring internalName = macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetName&lt;/span&gt;();\n\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (label != internalName)\n        {\n            &lt;span class=\"hljs-comment\"&gt;// Имена отличаются&lt;/span&gt;\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"451\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-451\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-451\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-451.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-4khs0n41\"&gt;GetLabel()&lt;/code&gt; обычно возвращает более \"дружественное\" имя, чем &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-jqobv0nq\"&gt;GetName()&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Для новых макрообъектов, созданных через API, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-b3qk32hn\"&gt;GetLabel()&lt;/code&gt; и &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-eimauuww\"&gt;GetName()&lt;/code&gt; могут возвращать одинаковые значения&lt;/li&gt;\n&lt;li&gt;Метод полезен при создании пользовательских интерфейсов для отображения объектов&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"addobjects-/-setobjects\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#addobjects-/-setobjects\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;AddObjects / SetObjects&lt;/span&gt;&lt;/a&gt;AddObjects / SetObjects&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-2-управление-содержимым\"&gt;Управление содержимым&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Добавление объектов в макрообъект или полная замена его содержимого.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\n&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-jvw5rq98\"&gt;AddObjects()&lt;/code&gt; добавляет переданные объекты к существующему содержимому макрообъекта. &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ptk28eow\"&gt;SetObjects()&lt;/code&gt; полностью заменяет содержимое макрообъекта новыми объектами. Оба метода принимают вектор указателей на объекты, реализующие интерфейс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-oi0xecac\"&gt;IKompasAPIObject&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;AddObjects&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; std::vector&amp;lt;IKompasAPIObjectPtr&amp;gt; &amp;amp; objects)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetObjects&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; std::vector&amp;lt;IKompasAPIObjectPtr&amp;gt; &amp;amp; objects)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"488\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-488\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-488\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-488.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры (для обоих методов):&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-xqfvz4m9\"&gt;objects&lt;/code&gt; (in) - вектор указателей на объекты для добавления/установки&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-gclsmfl8\"&gt;true&lt;/code&gt; - операция выполнена успешно, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-9sh2e7vl\"&gt;false&lt;/code&gt; - произошла ошибка&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya3\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya3\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;std::vector&amp;lt;ksapi::IKompasAPIObjectPtr&amp;gt; objects;\nobjects.&lt;span class=\"hljs-built_in\"&gt;push_back&lt;/span&gt;(lineSegment);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddObjects&lt;/span&gt;(objects);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"508\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-508\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-508\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-508.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Добавление объектов в макрообъект&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument2DPtr &lt;span class=\"hljs-title\"&gt;doc2D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc2D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObjectPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetEditMacroObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        std::vector&amp;lt;ksapi::IKompasAPIObjectPtr&amp;gt; objects;\n\n        &lt;span class=\"hljs-comment\"&gt;// Добавляем отрезок из коллекции документа&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::ILineSegmentsPtr &lt;span class=\"hljs-title\"&gt;lines&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetLineSegments())&lt;/span&gt;&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (lines &amp;amp;&amp;amp; lines-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;() &amp;gt; &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;)\n        {\n            objects.&lt;span class=\"hljs-built_in\"&gt;push_back&lt;/span&gt;(lines-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetLineSegment&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;));\n        }\n\n        &lt;span class=\"hljs-comment\"&gt;// Добавляем окружность&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::ICirclesPtr &lt;span class=\"hljs-title\"&gt;circles&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetCircles())&lt;/span&gt;&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (circles &amp;amp;&amp;amp; circles-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;() &amp;gt; &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;)\n        {\n            objects.&lt;span class=\"hljs-built_in\"&gt;push_back&lt;/span&gt;(circles-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCircle&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;));\n        }\n\n        &lt;span class=\"hljs-comment\"&gt;// Добавляем объекты в макрообъект&lt;/span&gt;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (!objects.&lt;span class=\"hljs-built_in\"&gt;empty&lt;/span&gt;())\n        {\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddObjects&lt;/span&gt;(objects);\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n        }\n\n        &lt;span class=\"hljs-comment\"&gt;// Полная замена содержимого через группу&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::IDrawingGroupPtr &lt;span class=\"hljs-title\"&gt;group&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetActiveDrawingGroup())&lt;/span&gt;&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (group)\n        {\n            std::vector&amp;lt;ksapi::IKompasAPIObjectPtr&amp;gt; newObjects;\n            newObjects.&lt;span class=\"hljs-built_in\"&gt;push_back&lt;/span&gt;(group);\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetObjects&lt;/span&gt;(newObjects);\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"512\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-512\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-512\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-512.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;После добавления объектов всегда необходимо вызывать &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-wpq1hc4x\"&gt;Update()&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Объекты должны быть созданы в том же документе, что и макрообъект&lt;/li&gt;\n&lt;li&gt;При добавлении объектов через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-yr96gr1z\"&gt;AddObjects()&lt;/code&gt; существующее содержимое макрообъекта сохраняется&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-kagf1gp1\"&gt;SetObjects()&lt;/code&gt; полностью заменяет содержимое, удаляя предыдущие объекты&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"findobject\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#findobject\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;FindObject&lt;/span&gt;&lt;/a&gt;FindObject&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-2-управление-содержимым\"&gt;Управление содержимым&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Поиск объекта в макроэлементе, ближайшего к заданной точке.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nИщет графический объект внутри макрообъекта, который находится ближе всего к указанной точке и удовлетворяет заданным параметрам поиска. Метод использует интерфейс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-fdd0vevg\"&gt;IFindObjectParameters&lt;/code&gt; для настройки критериев поиска.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; IDrawingObjectPtr &lt;span class=\"hljs-title\"&gt;FindObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; y, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; limit, &lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; IFindObjectParametersPtr &amp;amp; param)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"554\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-554\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-554\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-554.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-83w680yb\"&gt;x&lt;/code&gt; (in) - координата X точки поиска&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-jcbneq23\"&gt;y&lt;/code&gt; (in) - координата Y точки поиска&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-f83w5o12\"&gt;limit&lt;/code&gt; (in) - радиус поиска (максимальное расстояние от точки)&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-e5xpw1gb\"&gt;param&lt;/code&gt; (in) - параметры поиска объекта&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; Указатель на найденный объект или &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-3lwy444u\"&gt;nullptr&lt;/code&gt;, если объект не найден&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya4\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya4\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;ksapi::IFindObjectParametersPtr params = document-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetInterface&lt;/span&gt;(ksObjectFindObjectParameters);\nksapi::IDrawingObjectPtr found = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;FindObject&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;50&lt;/span&gt;, params);\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"589\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-589\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-589\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-589.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Поиск объекта в макрообъекте&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument2DPtr &lt;span class=\"hljs-title\"&gt;doc2D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc2D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObjectPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetEditMacroObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Получаем параметры поиска&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::IFindObjectParametersPtr &lt;span class=\"hljs-title\"&gt;findParams&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetInterface(ksObjectFindObjectParameters))&lt;/span&gt;&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (findParams)\n        {\n            &lt;span class=\"hljs-comment\"&gt;// Настраиваем параметры поиска&lt;/span&gt;\n            findParams-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetSearchInVisibleObjectsOnly&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n            findParams-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetConsiderObjectLayers&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n            findParams-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetObjectTypes&lt;/span&gt;(ksObjectTypeAll);\n\n            &lt;span class=\"hljs-comment\"&gt;// Ищем объект в центре макрообъекта&lt;/span&gt;\n            &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; centerX = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;, centerY = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;, angle = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n            &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirror = &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;;\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPlacement&lt;/span&gt;(centerX, centerY, angle, mirror);\n\n            &lt;span class=\"hljs-comment\"&gt;// Поиск в радиусе 100 единиц от центра&lt;/span&gt;\n            &lt;span class=\"hljs-function\"&gt;ksapi::IDrawingObjectPtr &lt;span class=\"hljs-title\"&gt;foundObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(macroObject-&amp;gt;FindObject(centerX, centerY, &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, findParams))&lt;/span&gt;&lt;/span&gt;;\n            &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (foundObject)\n            {\n                &lt;span class=\"hljs-comment\"&gt;// Объект найден - выделяем его&lt;/span&gt;\n                foundObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetSelected&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n            }\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"593\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-593\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-593\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-593.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Радиус поиска &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-g080ovpc\"&gt;limit&lt;/code&gt; задается в единицах измерения документа&lt;/li&gt;\n&lt;li&gt;Метод ищет только среди объектов, находящихся внутри макрообъекта&lt;/li&gt;\n&lt;li&gt;Для сложных поисков можно настроить &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-l4emb0eo\"&gt;IFindObjectParameters&lt;/code&gt; для фильтрации по типам объектов, слоям и другим критериям&lt;/li&gt;\n&lt;li&gt;Возвращаемый объект требует приведения к конкретному типу через соответствующий интерфейс&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"setdoubleclickeditable-/-isdoubleclickeditable\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setdoubleclickeditable-/-isdoubleclickeditable\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;SetDoubleClickEditable / IsDoubleClickEditable&lt;/span&gt;&lt;/a&gt;SetDoubleClickEditable / IsDoubleClickEditable&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-3-флаги-редактирования-и-специальные-флаги\"&gt;Флаги редактирования и специальные флаги&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Управление возможностью редактирования макрообъекта по двойному щелчку мыши.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nУстанавливает или проверяет, можно ли редактировать макрообъект двойным щелчком мыши в интерфейсе КОМПАС-3D. Когда этот флаг установлен, пользователь может дважды щелкнуть по макрообъекту для открытия диалога редактирования или запуска макроса.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetDoubleClickEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; editable)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;IsDoubleClickEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"635\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-635\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-635\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-635.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetDoubleClickEditable:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-li6cxo2h\"&gt;editable&lt;/code&gt; (in) - признак возможности редактирования по двойному щелчку&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение IsDoubleClickEditable:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-dxy4lifz\"&gt;true&lt;/code&gt; - редактирование разрешено, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-gnlw6asq\"&gt;false&lt;/code&gt; - запрещено&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya5\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya5\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Разрешаем редактирование по двойному щелчку&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetDoubleClickEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Проверяем текущее состояние&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; canEdit = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsDoubleClickEditable&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"655\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-655\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-655\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-655.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Настройка редактирования макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Включаем редактирование по двойному щелчку&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetDoubleClickEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Проверяем состояние&lt;/span&gt;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsDoubleClickEditable&lt;/span&gt;())\n        {\n            &lt;span class=\"hljs-comment\"&gt;// Редактирование разрешено&lt;/span&gt;\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"659\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-659\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-659\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-659.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Изменение этого флага требует вызова &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-lzg5l8up\"&gt;Update()&lt;/code&gt; для применения&lt;/li&gt;\n&lt;li&gt;При двойном щелчке может вызываться как стандартный диалог КОМПАС, так и пользовательский макрос, в зависимости от настроек &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-sy09k9mc\"&gt;IUserParameters&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Этот флаг влияет только на поведение в графическом интерфейсе, программное редактирование через API всегда доступно&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"sethotpointseditable-/-ishotpointseditable\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#sethotpointseditable-/-ishotpointseditable\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;SetHotPointsEditable / IsHotPointsEditable&lt;/span&gt;&lt;/a&gt;SetHotPointsEditable / IsHotPointsEditable&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-3-флаги-редактирования-и-специальные-флаги\"&gt;Флаги редактирования и специальные флаги&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Управление возможностью редактирования макрообъекта через характерные точки.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nУстанавливает или проверяет, можно ли редактировать макрообъект с помощью характерных точек (hot points) в графическом интерфейсе. Когда флаг установлен, пользователь может перетаскивать характерные точки для изменения геометрии макрообъекта.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetHotPointsEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; editable)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;IsHotPointsEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"696\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-696\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-696\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-696.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetHotPointsEditable:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-rq7l11mk\"&gt;editable&lt;/code&gt; (in) - признак возможности редактирования через характерные точки&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение IsHotPointsEditable:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-qvryyy1g\"&gt;true&lt;/code&gt; - редактирование разрешено, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-srypn2rk\"&gt;false&lt;/code&gt; - запрещено&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya6\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya6\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Разрешаем редактирование через характерные точки&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetHotPointsEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Проверяем состояние&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; hasHotPoints = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsHotPointsEditable&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"716\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-716\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-716\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-716.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Настройка характерных точек макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Включаем редактирование через характерные точки&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetHotPointsEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Добавляем характерную точку по умолчанию&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;150&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;);\n\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"720\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-720\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-720\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-720.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Характерные точки добавляются через метод &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-jhh0k1xl\"&gt;AddDefaultHotPoint()&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Макрообъект может иметь только одну характерную точку по умолчанию&lt;/li&gt;\n&lt;li&gt;При отключении редактирования рекомендуется удалять характерные точки через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-0pi8jaux\"&gt;DeleteDefaultHotPoint()&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Этот флаг влияет на отображение и поведение макрообъекта в графическом редакторе&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"setexternaleditable-/-isexternaleditable\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setexternaleditable-/-isexternaleditable\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;SetExternalEditable / IsExternalEditable&lt;/span&gt;&lt;/a&gt;SetExternalEditable / IsExternalEditable&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-3-флаги-редактирования-и-специальные-флаги\"&gt;Флаги редактирования и специальные флаги&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Управление поддержкой интерфейса внешнего управления макрообъектом.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nУстанавливает или проверяет, доступен ли макрообъект для управления через внешние приложения или скрипты. Когда флаг установлен, макрообъект может получать команды и данные из внешних источников через механизмы межпроцессного взаимодействия.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetExternalEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; editable)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;IsExternalEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"762\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-762\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-762\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-762.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetExternalEditable:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-k6lca4ma\"&gt;editable&lt;/code&gt; (in) - признак поддержки внешнего управления&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение IsExternalEditable:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-m89ekwkx\"&gt;true&lt;/code&gt; - внешнее управление разрешено, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-rm60rphn\"&gt;false&lt;/code&gt; - запрещено&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya7\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya7\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Разрешаем внешнее управление&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetExternalEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Проверяем состояние&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; externalAccess = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsExternalEditable&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"782\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-782\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-782\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-782.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Настройка внешнего управления макрообъектом&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Включаем внешнее управление&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetExternalEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPropertyObjectEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"786\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-786\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-786\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-786.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Внешнее управление обычно используется для интеграции с системами автоматизации&lt;/li&gt;\n&lt;li&gt;При включенном внешнем управлении рекомендуется отключать UI-редактирование для предотвращения конфликтов&lt;/li&gt;\n&lt;li&gt;Внешние приложения могут использовать &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-8e5vr9ez\"&gt;IUserParameters&lt;/code&gt; для передачи данных макрообъекту&lt;/li&gt;\n&lt;li&gt;Флаг влияет на безопасность - не включайте его для макрообъектов, которые не должны управляться извне&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"setpropertyobjecteditable-/-ispropertyobjecteditable\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setpropertyobjecteditable-/-ispropertyobjecteditable\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;SetPropertyObjectEditable / IsPropertyObjectEditable&lt;/span&gt;&lt;/a&gt;SetPropertyObjectEditable / IsPropertyObjectEditable&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-3-флаги-редактирования-и-специальные-флаги\"&gt;Флаги редактирования и специальные флаги&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Управление поддержкой интерфейса внешних свойств объекта.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nУстанавливает или проверяет, доступен ли макрообъект для редактирования через интерфейс внешних свойств. Когда флаг установлен, макрообъект может отображать и редактировать пользовательские свойства через панель свойств КОМПАС или внешние приложения.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetPropertyObjectEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; editable)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;IsPropertyObjectEditable&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"828\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-828\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-828\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-828.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetPropertyObjectEditable:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-9jdh2ep8\"&gt;editable&lt;/code&gt; (in) - признак поддержки внешних свойств&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение IsPropertyObjectEditable:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ps60380t\"&gt;true&lt;/code&gt; - редактирование свойств разрешено, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-f6ro59pv\"&gt;false&lt;/code&gt; - запрещено&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya8\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya8\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Включаем поддержку внешних свойств&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPropertyObjectEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Проверяем состояние&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; hasProperties = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsPropertyObjectEditable&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"848\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-848\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-848\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-848.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Настройка свойств макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Включаем интерфейс свойств&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPropertyObjectEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Получаем интерфейс для работы со свойствами&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::IPropertyKeeperPtr &lt;span class=\"hljs-title\"&gt;propKeeper&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(macroObject)&lt;/span&gt;&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (propKeeper)\n        {\n            &lt;span class=\"hljs-comment\"&gt;// Добавляем пользовательские свойства&lt;/span&gt;\n            propKeeper-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddProperty&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Материал\"&lt;/span&gt;, &lt;span class=\"hljs-string\"&gt;L\"Сталь\"&lt;/span&gt;, ksPropertyTypeString);\n            propKeeper-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddProperty&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Масса\"&lt;/span&gt;, &lt;span class=\"hljs-string\"&gt;L\"10.5\"&lt;/span&gt;, ksPropertyTypeDouble);\n        }\n\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"852\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-852\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-852\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-852.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;При включении &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-f3ujp2ot\"&gt;SetPropertyObjectEditable(true)&lt;/code&gt; макрообъект получает возможность отображать пользовательские свойства в панели свойств КОМПАС&lt;/li&gt;\n&lt;li&gt;Для работы со свойствами необходимо также реализовать интерфейс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-rizgaych\"&gt;IPropertyKeeper&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Свойства могут быть различных типов: строковые, числовые, логические и т.д.&lt;/li&gt;\n&lt;li&gt;Изменения свойств через панель свойств автоматически вызывают обновление макрообъекта&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"setcreatespcobjects-/-iscreatespcobjects\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setcreatespcobjects-/-iscreatespcobjects\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;SetCreateSpcObjects / IsCreateSpcObjects&lt;/span&gt;&lt;/a&gt;SetCreateSpcObjects / IsCreateSpcObjects&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-3-флаги-редактирования-и-специальные-флаги\"&gt;Флаги редактирования и специальные флаги&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Управление созданием объектов спецификации при вставке макрообъекта.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nУстанавливает или проверяет, создаются ли автоматически объекты спецификации при вставке макрообъекта в чертеж. Когда флаг установлен, система КОМПАС автоматически создает соответствующие записи в спецификации для объектов, содержащихся в макрообъекте.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetCreateSpcObjects&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; create)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;IsCreateSpcObjects&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"894\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-894\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-894\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-894.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetCreateSpcObjects:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-chbpkuv3\"&gt;create&lt;/code&gt; (in) - признак создания объектов спецификации&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение IsCreateSpcObjects:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-y7r5rsg1\"&gt;true&lt;/code&gt; - создание разрешено, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-bicp2edj\"&gt;false&lt;/code&gt; - запрещено&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya9\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya9\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Разрешаем создание объектов спецификации&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetCreateSpcObjects&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Проверяем состояние&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; createsSpc = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsCreateSpcObjects&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"914\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-914\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-914\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-914.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Настройка спецификации для макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Включаем создание объектов спецификации&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetCreateSpcObjects&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Устанавливаем имя для идентификации в спецификации&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Деталь_001_Спецификация\"&lt;/span&gt;);\n\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"918\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-918\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-918\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-918.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Флаг влияет только на автоматическое создание объектов спецификации при вставке&lt;/li&gt;\n&lt;li&gt;Для ручного управления спецификацией необходимо использовать интерфейсы работы со спецификацией&lt;/li&gt;\n&lt;li&gt;При включенном создании объектов спецификации рекомендуется также включать &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-z2gwnqt9\"&gt;SetPropertyObjectEditable(true)&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Объекты спецификации создаются в соответствии с настройками документа и шаблонами спецификации&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"setbreakobjectsenabled-/-isbreakobjectsenabled\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setbreakobjectsenabled-/-isbreakobjectsenabled\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;SetBreakObjectsEnabled / IsBreakObjectsEnabled&lt;/span&gt;&lt;/a&gt;SetBreakObjectsEnabled / IsBreakObjectsEnabled&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-3-флаги-редактирования-и-специальные-флаги\"&gt;Флаги редактирования и специальные флаги&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Управление учетом разрыва вида для объектов внутри макрообъекта.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\nУстанавливает или проверяет, учитывается ли разрыв вида для объектов, содержащихся в макрообъекте. Когда флаг установлен, объекты внутри макрообъекта корректно отображаются и обрабатываются при наличии разрывов на виде.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SetBreakObjectsEnabled&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; enabled)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;IsBreakObjectsEnabled&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"960\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-960\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-960\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-960.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры SetBreakObjectsEnabled:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-w66ilt6f\"&gt;enabled&lt;/code&gt; (in) - признак учета разрыва вида&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение IsBreakObjectsEnabled:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vyl91scu\"&gt;true&lt;/code&gt; - учет разрешен, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-adt12bpv\"&gt;false&lt;/code&gt; - запрещен&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya10\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya10\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Включаем учет разрыва вида&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetBreakObjectsEnabled&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Проверяем состояние&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; breakEnabled = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsBreakObjectsEnabled&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"980\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-980\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-980\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-980.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Настройка разрывов вида для макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Устанавливаем флаг учета разрывов&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetBreakObjectsEnabled&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Включаем редактирование характерных точек для настройки разрывов&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetHotPointsEditable&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Добавляем характерные точки для управления разрывами&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;200&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;150&lt;/span&gt;);\n\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"984\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-984\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-984\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-984.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Флаг влияет на отображение объектов внутри макрообъекта при наличии разрывов на виде&lt;/li&gt;\n&lt;li&gt;При включенном учете разрывов рекомендуется использовать характерные точки для управления положением объектов&lt;/li&gt;\n&lt;li&gt;Для сложных макрообъектов с множеством внутренних элементов учет разрывов может влиять на производительность&lt;/li&gt;\n&lt;li&gt;Флаг следует устанавливать в соответствии с требованиями к отображению на конкретном виде&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"adddefaulthotpoint-/-deletedefaulthotpoint\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#adddefaulthotpoint-/-deletedefaulthotpoint\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;AddDefaultHotPoint / DeleteDefaultHotPoint&lt;/span&gt;&lt;/a&gt;AddDefaultHotPoint / DeleteDefaultHotPoint&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-4-характерные-точки\"&gt;Характерные точки&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Добавление и удаление характерной точки макрообъекта.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\n&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vxxiqsyp\"&gt;AddDefaultHotPoint()&lt;/code&gt; добавляет характерную точку (hot point) к макрообъекту в указанных координатах. &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-55v26wy0\"&gt;DeleteDefaultHotPoint()&lt;/code&gt; удаляет существующую характерную точку. Характерные точки используются для интерактивного редактирования макрообъекта в графическом интерфейсе.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;AddDefaultHotPoint&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; y)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;DeleteDefaultHotPoint&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1026\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1026\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1026\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1026.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры AddDefaultHotPoint:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-drsg8o4m\"&gt;x&lt;/code&gt; (in) - координата X характерной точки в СК макрообъекта&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-725z7qpd\"&gt;y&lt;/code&gt; (in) - координата Y характерной точки в СК макрообъекта&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-tv0goksg\"&gt;true&lt;/code&gt; - операция выполнена успешно, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-4vwfo8i7\"&gt;false&lt;/code&gt; - произошла ошибка&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya11\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya11\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Добавляем характерную точку&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;);\n\n&lt;span class=\"hljs-comment\"&gt;// Удаляем характерную точку&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;DeleteDefaultHotPoint&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1051\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1051\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1051\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1051.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Управление характерными точками макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Проверяем, поддерживает ли макрообъект характерные точки&lt;/span&gt;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsHotPointsEditable&lt;/span&gt;())\n        {\n            &lt;span class=\"hljs-comment\"&gt;// Удаляем старую точку, если есть&lt;/span&gt;\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;DeleteDefaultHotPoint&lt;/span&gt;();\n\n            &lt;span class=\"hljs-comment\"&gt;// Получаем текущее положение макрообъекта&lt;/span&gt;\n            &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x, y, angle;\n            &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirror;\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPlacement&lt;/span&gt;(x, y, angle, mirror);\n\n            &lt;span class=\"hljs-comment\"&gt;// Добавляем характерную точку в центре&lt;/span&gt;\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(x, y);\n\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1055\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1055\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1055\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1055.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Макрообъект может иметь только одну характерную точку по умолчанию&lt;/li&gt;\n&lt;li&gt;Координаты точки задаются в системе координат макрообъекта&lt;/li&gt;\n&lt;li&gt;Перед добавлением новой точки рекомендуется удалять старую через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-pvtd4fiq\"&gt;DeleteDefaultHotPoint()&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Характерные точки работают только при включенном флаге &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-m6q04cpd\"&gt;IsHotPointsEditable()&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"getattachedleaders-/-deleteattachedleaders\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getattachedleaders-/-deleteattachedleaders\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;GetAttachedLeaders / DeleteAttachedLeaders&lt;/span&gt;&lt;/a&gt;GetAttachedLeaders / DeleteAttachedLeaders&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-5-присоединенные-выноски\"&gt;Присоединенные выноски&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Получение коллекции присоединенных линий-выносок и их удаление.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\n&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-s2um5yp5\"&gt;GetAttachedLeaders()&lt;/code&gt; возвращает коллекцию линий-выносок, присоединенных к макрообъекту. &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-gcseoot5\"&gt;DeleteAttachedLeaders()&lt;/code&gt; удаляет все присоединенные линии-выноски. Выноски используются для создания аннотаций и обозначений, связанных с макрообъектом.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; ILeadersPtr &lt;span class=\"hljs-title\"&gt;GetAttachedLeaders&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;DeleteAttachedLeaders&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;()&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1097\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1097\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1097\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1097.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение GetAttachedLeaders:&lt;/strong&gt; Указатель на коллекцию линий-выносок &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-x9lm1h4b\"&gt;ILeadersPtr&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение DeleteAttachedLeaders:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-6kgbkmrh\"&gt;true&lt;/code&gt; - удаление выполнено успешно, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-dpli8e7g\"&gt;false&lt;/code&gt; - произошла ошибка&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya12\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya12\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Получаем коллекцию присоединенных выносок&lt;/span&gt;\nksapi::ILeadersPtr leaders = macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetAttachedLeaders&lt;/span&gt;();\n\n&lt;span class=\"hljs-comment\"&gt;// Удаляем все присоединенные выноски&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;DeleteAttachedLeaders&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1110\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1110\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1110\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1110.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Работа с присоединенными линиями-выносками&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument2DPtr &lt;span class=\"hljs-title\"&gt;doc2D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc2D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObjectPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetEditMacroObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Получаем коллекцию присоединенных выносок&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::ILeadersPtr &lt;span class=\"hljs-title\"&gt;leaders&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(macroObject-&amp;gt;GetAttachedLeaders())&lt;/span&gt;&lt;/span&gt;;\n\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (leaders &amp;amp;&amp;amp; leaders-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;() &amp;gt; &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;)\n        {\n            &lt;span class=\"hljs-comment\"&gt;// Выводим информацию о выносках&lt;/span&gt;\n            &lt;span class=\"hljs-type\"&gt;int&lt;/span&gt; leaderCount = leaders-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetCount&lt;/span&gt;();\n\n            &lt;span class=\"hljs-comment\"&gt;// Проходим по всем выноскам&lt;/span&gt;\n            &lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;int&lt;/span&gt; i = &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;; i &amp;lt; leaderCount; i++)\n            {\n                &lt;span class=\"hljs-function\"&gt;ksapi::ILeaderPtr &lt;span class=\"hljs-title\"&gt;leader&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(leaders-&amp;gt;GetLeader(i))&lt;/span&gt;&lt;/span&gt;;\n                &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (leader)\n                {\n                    &lt;span class=\"hljs-comment\"&gt;// Получаем свойства выноски&lt;/span&gt;\n                    std::wstring text = leader-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetText&lt;/span&gt;();\n                    &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x, y;\n                    leader-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPosition&lt;/span&gt;(x, y);\n\n                    &lt;span class=\"hljs-comment\"&gt;// Можно модифицировать выноски&lt;/span&gt;\n                    leader-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetText&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Обозначение: \"&lt;/span&gt; + std::&lt;span class=\"hljs-built_in\"&gt;to_wstring&lt;/span&gt;(i + &lt;span class=\"hljs-number\"&gt;1&lt;/span&gt;));\n                    leader-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n                }\n            }\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1114\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1114\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1114\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1114.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Линии-выноски создаются в контексте документа, а не макрообъекта&lt;/li&gt;\n&lt;li&gt;Метод &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-gf9pblrh\"&gt;GetAttachedLeaders()&lt;/code&gt; возвращает только выноски, явно присоединенные к макрообъекту&lt;/li&gt;\n&lt;li&gt;Удаление через &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-bd2cv66k\"&gt;DeleteAttachedLeaders()&lt;/code&gt; необратимо - выноски удаляются из документа&lt;/li&gt;\n&lt;li&gt;Для создания новых выносок необходимо использовать интерфейс &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-vzeddhih\"&gt;ILeaders&lt;/code&gt; из контейнера документа&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"transformpointtoview-/-transformpointfromview\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#transformpointtoview-/-transformpointfromview\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;TransformPointToView / TransformPointFromView&lt;/span&gt;&lt;/a&gt;TransformPointToView / TransformPointFromView&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-6-преобразование-координат\"&gt;Преобразование координат&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Преобразование координат точки между системами координат макрообъекта и вида.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\n&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-i4exajwq\"&gt;TransformPointToView()&lt;/code&gt; преобразует координаты точки из системы координат макрообъекта в систему координат вида. &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-li586pkl\"&gt;TransformPointFromView()&lt;/code&gt; выполняет обратное преобразование из системы координат вида в систему координат макрообъекта. Учитываются положение, поворот и отражение макрообъекта.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;TransformPointToView&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; x, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; y)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;TransformPointFromView&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; x, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; y)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1156\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1156\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1156\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1156.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры (для обоих методов):&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-f9dbbjl7\"&gt;x&lt;/code&gt; (in/out) - координата X точки для преобразования&lt;/li&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-ka40pbid\"&gt;y&lt;/code&gt; (in/out) - координата Y точки для преобразования&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-llbai0o9\"&gt;true&lt;/code&gt; - преобразование выполнено успешно, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-j5bricoj\"&gt;false&lt;/code&gt; - произошла ошибка&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya13\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya13\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Преобразование из СК макрообъекта в СК вида&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; pointX = &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, pointY = &lt;span class=\"hljs-number\"&gt;50&lt;/span&gt;;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformPointToView&lt;/span&gt;(pointX, pointY);\n\n&lt;span class=\"hljs-comment\"&gt;// Обратное преобразование&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformPointFromView&lt;/span&gt;(pointX, pointY);\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1181\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1181\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1181\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1181.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Преобразование координат для работы с макрообъектом&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument2DPtr &lt;span class=\"hljs-title\"&gt;doc2D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc2D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObjectPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetEditMacroObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Получаем текущее положение макрообъекта&lt;/span&gt;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; macroX, macroY, angle;\n        &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirror;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPlacement&lt;/span&gt;(macroX, macroY, angle, mirror);\n\n        &lt;span class=\"hljs-comment\"&gt;// Точка в системе координат макрообъекта&lt;/span&gt;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; localPointX = &lt;span class=\"hljs-number\"&gt;100.0&lt;/span&gt;;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; localPointY = &lt;span class=\"hljs-number\"&gt;50.0&lt;/span&gt;;\n\n        &lt;span class=\"hljs-comment\"&gt;// Преобразование в систему координат вида&lt;/span&gt;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; viewPointX = localPointX;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; viewPointY = localPointY;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformPointToView&lt;/span&gt;(viewPointX, viewPointY);\n\n        &lt;span class=\"hljs-comment\"&gt;// Обратное преобразование (проверка)&lt;/span&gt;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; checkX = viewPointX;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; checkY = viewPointY;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformPointFromView&lt;/span&gt;(checkX, checkY);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1185\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1185\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1185\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1185.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Преобразования учитывают положение (&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-jtq4zvli\"&gt;GetPlacement&lt;/code&gt;), поворот и зеркальное отражение макрообъекта&lt;/li&gt;\n&lt;li&gt;Для корректной работы макрообъект должен быть валидным и обновленным (&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-mi3gvb0v\"&gt;Update()&lt;/code&gt;)&lt;/li&gt;\n&lt;li&gt;Преобразования полезны для:\n&lt;ul&gt;\n&lt;li&gt;Размещения объектов относительно макрообъекта&lt;/li&gt;\n&lt;li&gt;Проверки попадания точек в область макрообъекта&lt;/li&gt;\n&lt;li&gt;Отображения подсказок и аннотаций в правильных позициях&lt;/li&gt;\n&lt;li&gt;Реализации интерактивного редактирования&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;При ошибке преобразования методы возвращают &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-rb2t6gw4\"&gt;false&lt;/code&gt;, а координаты не изменяются&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h3 id=\"transformangletoview-/-transformanglefromview\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#transformangletoview-/-transformanglefromview\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;TransformAngleToView / TransformAngleFromView&lt;/span&gt;&lt;/a&gt;TransformAngleToView / TransformAngleFromView&lt;/h3&gt;\n&lt;p&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#группа-6-преобразование-координат\"&gt;Преобразование координат&lt;/a&gt; | &lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#методы-интерфейса\"&gt;К оглавлению&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Кратко:&lt;/strong&gt; Преобразование угла между системами координат макрообъекта и вида.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Полное описание:&lt;/strong&gt;&lt;br /&gt;\n&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-3sz5im6o\"&gt;TransformAngleToView()&lt;/code&gt; преобразует угол из системы координат макрообъекта в систему координат вида. &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-dc8eh64f\"&gt;TransformAngleFromView()&lt;/code&gt; выполняет обратное преобразование из системы координат вида в систему координат макрообъекта. Учитывается поворот макрообъекта относительно вида.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Синтаксис:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;TransformAngleToView&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; angle)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-keyword\"&gt;virtual&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;TransformAngleFromView&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; angle)&lt;/span&gt; &lt;/span&gt;= &lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1249\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1249\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1249\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1249.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Параметры (для обоих методов):&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-0h7570ck\"&gt;angle&lt;/code&gt; (in/out) - угол в градусах для преобразования&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Возвращаемое значение:&lt;/strong&gt; &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-or5kt8nb\"&gt;true&lt;/code&gt; - преобразование выполнено успешно, &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-fm5wawp1\"&gt;false&lt;/code&gt; - произошла ошибка&lt;/p&gt;\n&lt;h4 id=\"primer-ispolzovaniya14\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya14\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Пример использования&lt;/span&gt;&lt;/a&gt;&lt;strong&gt;Пример использования&lt;/strong&gt;&lt;/h4&gt;\n&lt;p&gt;&lt;strong&gt;Минимальный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Преобразование угла из СК макрообъекта в СК вида&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; angle = &lt;span class=\"hljs-number\"&gt;45.0&lt;/span&gt;; &lt;span class=\"hljs-comment\"&gt;// 45 градусов в системе макрообъекта&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformAngleToView&lt;/span&gt;(angle);\n\n&lt;span class=\"hljs-comment\"&gt;// Обратное преобразование&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformAngleFromView&lt;/span&gt;(angle);\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1269\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1269\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1269\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1269.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Расширенный пример:&lt;/strong&gt;&lt;/p&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Преобразование углов для работы с макрообъектом&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument2DPtr &lt;span class=\"hljs-title\"&gt;doc2D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc2D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObjectPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc2D-&amp;gt;GetEditMacroObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Получаем текущий угол поворота макрообъекта&lt;/span&gt;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; macroX, macroY, macroAngle;\n        &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirror;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPlacement&lt;/span&gt;(macroX, macroY, macroAngle, mirror);\n\n        &lt;span class=\"hljs-comment\"&gt;// Тестируем преобразование углов&lt;/span&gt;\n        std::vector&amp;lt;&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt;&amp;gt; testAngles = {&lt;span class=\"hljs-number\"&gt;0.0&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;45.0&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;90.0&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;180.0&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;270.0&lt;/span&gt;};\n\n        &lt;span class=\"hljs-keyword\"&gt;for&lt;/span&gt; (&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; localAngle : testAngles)\n        {\n            &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; angleToView = localAngle;\n            &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; angleFromView = localAngle;\n\n            &lt;span class=\"hljs-comment\"&gt;// Преобразование в систему вида&lt;/span&gt;\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformAngleToView&lt;/span&gt;(angleToView);\n\n            &lt;span class=\"hljs-comment\"&gt;// Обратное преобразование (для проверки)&lt;/span&gt;\n            macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformAngleFromView&lt;/span&gt;(angleFromView);\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1273\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1273\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1273\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1273.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;strong&gt;Примечания:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Углы задаются в градусах&lt;/li&gt;\n&lt;li&gt;Преобразования учитывают только поворот макрообъекта, зеркальное отражение не влияет на углы&lt;/li&gt;\n&lt;li&gt;Методы полезны для:\n&lt;ul&gt;\n&lt;li&gt;Создания объектов, ориентированных относительно макрообъекта&lt;/li&gt;\n&lt;li&gt;Выравнивания текста и аннотаций&lt;/li&gt;\n&lt;li&gt;Проверки геометрических отношений между объектами&lt;/li&gt;\n&lt;li&gt;Реализации интерактивных инструментов редактирования&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;При ошибке преобразования методы возвращают &lt;code class=\"yfm-clipboard-inline-code\" role=\"button\" tabindex=\"0\" id=\"inline-code-id-08jj26pc\"&gt;false&lt;/code&gt;, а угол не изменяется&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"chastye-oshibki\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#chastye-oshibki\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Частые ошибки&lt;/span&gt;&lt;/a&gt;Частые ошибки&lt;/h2&gt;\n&lt;h3 id=\"1-zabyvayut-vyzyvat-update\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#1-zabyvayut-vyzyvat-update\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;1. Забывают вызывать Update()&lt;/span&gt;&lt;/a&gt;1. &lt;strong&gt;Забывают вызывать Update()&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPlacement&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;45&lt;/span&gt;, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;);\n&lt;span class=\"hljs-comment\"&gt;// Изменения не применены!&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPlacement&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;45&lt;/span&gt;, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;(); &lt;span class=\"hljs-comment\"&gt;// Обязательный вызов!&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1328\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1328\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1328\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1328.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"2-ispolzovanie-nevalidnyh-ukazatelej\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#2-ispolzovanie-nevalidnyh-ukazatelej\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;2. Использование невалидных указателей&lt;/span&gt;&lt;/a&gt;2. &lt;strong&gt;Использование невалидных указателей&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nksapi::IMacroObjectPtr macroObj; &lt;span class=\"hljs-comment\"&gt;// Не инициализирован&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Test\"&lt;/span&gt;); &lt;span class=\"hljs-comment\"&gt;// Ошибка доступа!&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject)\n    {\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Test\"&lt;/span&gt;);\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1332\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1332\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1332\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1332.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"3-nesootvetstvie-sistem-koordinat\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#3-nesootvetstvie-sistem-koordinat\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;3. Несоответствие систем координат&lt;/span&gt;&lt;/a&gt;3. &lt;strong&gt;Несоответствие систем координат&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x = &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, y = &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;;\n&lt;span class=\"hljs-comment\"&gt;// Координаты в системе вида, а нужны в системе макрообъекта&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(x, y);\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\n&lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x = &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, y = &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;;\n&lt;span class=\"hljs-comment\"&gt;// Преобразуем в систему макрообъекта&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;TransformPointFromView&lt;/span&gt;(x, y);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(x, y);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1336\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1336\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1336\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1336.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"4-mnozhestvennoe-dobavlenie-harakternyh-tochek\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#4-mnozhestvennoe-dobavlenie-harakternyh-tochek\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;4. Множественное добавление характерных точек&lt;/span&gt;&lt;/a&gt;4. &lt;strong&gt;Множественное добавление характерных точек&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;100&lt;/span&gt;);\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;200&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;200&lt;/span&gt;); &lt;span class=\"hljs-comment\"&gt;// Заменяет предыдущую&lt;/span&gt;\n&lt;span class=\"hljs-comment\"&gt;// Остается только последняя точка&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;DeleteDefaultHotPoint&lt;/span&gt;(); &lt;span class=\"hljs-comment\"&gt;// Удаляем старую&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;AddDefaultHotPoint&lt;/span&gt;(&lt;span class=\"hljs-number\"&gt;200&lt;/span&gt;, &lt;span class=\"hljs-number\"&gt;200&lt;/span&gt;); &lt;span class=\"hljs-comment\"&gt;// Добавляем новую&lt;/span&gt;\nmacroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1340\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1340\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1340\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1340.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"5-nepravilnoe-ispolzovanie-smartptr\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#5-nepravilnoe-ispolzovanie-smartptr\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;5. Неправильное использование SmartPtr&lt;/span&gt;&lt;/a&gt;5. &lt;strong&gt;Неправильное использование SmartPtr&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО (избыточно)&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IMacroObjectPtr &lt;span class=\"hljs-title\"&gt;macroObj&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(drawingObj.Get())&lt;/span&gt;&lt;/span&gt;;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО (SmartPtr делает это автоматически)&lt;/span&gt;\nksapi::IMacroObjectPtr macroObj = drawingObj;\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1344\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1344\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1344\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1344.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"6-neproverka-ukazatelej-posle-privedeniya-smartptr\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#6-neproverka-ukazatelej-posle-privedeniya-smartptr\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;6. Непроверка указателей после приведения SmartPtr&lt;/span&gt;&lt;/a&gt;6. &lt;strong&gt;Непроверка указателей после приведения SmartPtr&lt;/strong&gt;&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// НЕПРАВИЛЬНО&lt;/span&gt;\nksapi::IUserParametersPtr userParams = macroObj;\nuserParams-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetLibraryFileName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Test.dll\"&lt;/span&gt;); &lt;span class=\"hljs-comment\"&gt;// Опасно!&lt;/span&gt;\n\n&lt;span class=\"hljs-comment\"&gt;// ПРАВИЛЬНО&lt;/span&gt;\nksapi::IUserParametersPtr userParams = macroObj;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (userParams) &lt;span class=\"hljs-comment\"&gt;// Всегда проверяйте указатели после приведения&lt;/span&gt;\n{\n    userParams-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetLibraryFileName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"Test.dll\"&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1348\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1348\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1348\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1348.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;hr /&gt;\n&lt;h2 id=\"shablony-koda-iz-ishodnikov\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#shablony-koda-iz-ishodnikov\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Шаблоны кода из исходников&lt;/span&gt;&lt;/a&gt;Шаблоны кода из исходников&lt;/h2&gt;\n&lt;h3 id=\"tipichnaya-struktura-obrabotki-makroobuekta-iz-orificecpp\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#tipichnaya-struktura-obrabotki-makroobuekta-iz-orificecpp\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Типичная структура обработки макрообъекта (из Orifice.cpp)&lt;/span&gt;&lt;/a&gt;Типичная структура обработки макрообъекта (из Orifice.cpp)&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Получение активного документа&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;ksapi::IKompasDocument3DPtr &lt;span class=\"hljs-title\"&gt;doc3D&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksAppl ? ksAppl-&amp;gt;GetActiveDocument() : &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (doc3D)\n{\n    &lt;span class=\"hljs-comment\"&gt;// Получение редактируемого макрообъекта&lt;/span&gt;\n    &lt;span class=\"hljs-function\"&gt;ksapi::IMacroObject3DPtr &lt;span class=\"hljs-title\"&gt;macroObject&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(doc3D-&amp;gt;GetLibraryEditObject())&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObject &amp;amp;&amp;amp; macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;IsValid&lt;/span&gt;())\n    {\n        &lt;span class=\"hljs-comment\"&gt;// Получение параметров размещения&lt;/span&gt;\n        &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; x, y, angle;\n        &lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt; mirror;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetPlacement&lt;/span&gt;(x, y, angle, mirror);\n\n        &lt;span class=\"hljs-comment\"&gt;// Изменение параметров&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetPlacement&lt;/span&gt;(x, y, angle, mirror, &lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;);\n\n        &lt;span class=\"hljs-comment\"&gt;// Получение подчиненных объектов (эскиз, операция)&lt;/span&gt;\n        &lt;span class=\"hljs-function\"&gt;ksapi::IFeaturePtr &lt;span class=\"hljs-title\"&gt;macroFeature&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(macroObject)&lt;/span&gt;&lt;/span&gt;;\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroFeature)\n        {\n            std::vector&amp;lt;ksapi::IFeaturePtr&amp;gt; objects = macroFeature-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetSubFeatures&lt;/span&gt;(ksOperTree, &lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;, &lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;);\n            &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (objects.&lt;span class=\"hljs-built_in\"&gt;size&lt;/span&gt;() &amp;gt;= &lt;span class=\"hljs-number\"&gt;2&lt;/span&gt;)\n            {\n                &lt;span class=\"hljs-function\"&gt;ksapi::ISketchPtr &lt;span class=\"hljs-title\"&gt;sketch&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(objects[&lt;span class=\"hljs-number\"&gt;0&lt;/span&gt;])&lt;/span&gt;&lt;/span&gt;;\n                &lt;span class=\"hljs-function\"&gt;ksapi::IExtrusionPtr &lt;span class=\"hljs-title\"&gt;cutExtrusion&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(objects[&lt;span class=\"hljs-number\"&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;/span&gt;;\n\n                &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (sketch)\n                {\n                    &lt;span class=\"hljs-comment\"&gt;// Редактирование эскиза&lt;/span&gt;\n                    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (ksapi::IKompasDocument2DPtr document = sketch-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;BeginEdit&lt;/span&gt;(&lt;span class=\"hljs-literal\"&gt;false&lt;/span&gt;))\n                    {\n                        &lt;span class=\"hljs-comment\"&gt;// Создание геометрии&lt;/span&gt;\n                        ksapi::IDrawingObjectPtr circle = &lt;span class=\"hljs-comment\"&gt;/* создание окружности */&lt;/span&gt;;\n                        sketch-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;EndEdit&lt;/span&gt;();\n                    }\n                    sketch-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n                }\n            }\n        }\n\n        &lt;span class=\"hljs-comment\"&gt;// Обновление макрообъекта&lt;/span&gt;\n        macroObject-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;Update&lt;/span&gt;();\n\n        &lt;span class=\"hljs-comment\"&gt;// Перестроение документа&lt;/span&gt;\n        doc3D-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;RebuildDocument&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1356\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1356\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1356\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1356.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"rabota-s-polzovatelskimi-dannymi-iz-orificecpp\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#rabota-s-polzovatelskimi-dannymi-iz-orificecpp\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Работа с пользовательскими данными (из Orifice.cpp)&lt;/span&gt;&lt;/a&gt;Работа с пользовательскими данными (из Orifice.cpp)&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Структура параметров макрообъекта&lt;/span&gt;\n&lt;span class=\"hljs-keyword\"&gt;struct&lt;/span&gt; &lt;span class=\"hljs-title class_\"&gt;MacroPar&lt;/span&gt;\n{\n    &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; diam;\n};\n\n&lt;span class=\"hljs-comment\"&gt;// Сохранение пользовательских данных&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;SaveUserData&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksapi::IMacroObject3DPtr macroObject, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; diameter)&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IUserDataStoragePtr &lt;span class=\"hljs-title\"&gt;userData&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(macroObject)&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (userData)\n    {\n        MacroPar pars{diameter};\n        &lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; * params = &lt;span class=\"hljs-built_in\"&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; *&amp;gt;(&amp;amp;pars);\n        &lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;uint8_t&lt;/span&gt; * data = &lt;span class=\"hljs-built_in\"&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=\"hljs-type\"&gt;const&lt;/span&gt; &lt;span class=\"hljs-type\"&gt;uint8_t&lt;/span&gt; *&amp;gt;(params);\n        userData-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;SetUserParams&lt;/span&gt;(std::vector&amp;lt;&lt;span class=\"hljs-type\"&gt;uint8_t&lt;/span&gt;&amp;gt;{data, data + &lt;span class=\"hljs-built_in\"&gt;sizeof&lt;/span&gt;(pars)});\n    }\n}\n\n&lt;span class=\"hljs-comment\"&gt;// Загрузка пользовательских данных&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;LoadUserData&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(ksapi::IMacroObject3DPtr macroObject, &lt;span class=\"hljs-type\"&gt;double&lt;/span&gt; &amp;amp; diameter)&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=\"hljs-function\"&gt;ksapi::IUserDataStoragePtr &lt;span class=\"hljs-title\"&gt;userData&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(macroObject)&lt;/span&gt;&lt;/span&gt;;\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (userData)\n    {\n        std::vector&amp;lt;&lt;span class=\"hljs-type\"&gt;uint8_t&lt;/span&gt;&amp;gt; userParams = userData-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetUserParams&lt;/span&gt;();\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (userParams.&lt;span class=\"hljs-built_in\"&gt;size&lt;/span&gt;() == &lt;span class=\"hljs-built_in\"&gt;sizeof&lt;/span&gt;(MacroPar))\n        {\n            MacroPar * pars = &lt;span class=\"hljs-built_in\"&gt;reinterpret_cast&lt;/span&gt;&amp;lt;MacroPar *&amp;gt;(userParams.&lt;span class=\"hljs-built_in\"&gt;data&lt;/span&gt;());\n            diameter = pars-&amp;gt;diam;\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1360\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1360\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1360\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1360.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n&lt;h3 id=\"inicializaciya-biblioteki-iz-macroobjcpp\"&gt;&lt;a href=\"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#inicializaciya-biblioteki-iz-macroobjcpp\" class=\"yfm-anchor\" aria-hidden=\"true\"&gt;&lt;span class=\"visually-hidden\" data-no-index=\"true\"&gt;Инициализация библиотеки (из MacroObj.cpp)&lt;/span&gt;&lt;/a&gt;Инициализация библиотеки (из MacroObj.cpp)&lt;/h3&gt;\n\n    &lt;div class=\"yfm-clipboard\"&gt;\n        &lt;pre&gt;&lt;code class=\"hljs cpp\"&gt;&lt;span class=\"hljs-comment\"&gt;// Глобальные переменные&lt;/span&gt;\nksapi::IApplication * ksAppl = &lt;span class=\"hljs-literal\"&gt;nullptr&lt;/span&gt;;\nksapi::IProceduresLibraryPtr myLibrary;\n\n&lt;span class=\"hljs-comment\"&gt;// Головная функция библиотеки&lt;/span&gt;\n&lt;span class=\"hljs-function\"&gt;&lt;span class=\"hljs-type\"&gt;void&lt;/span&gt; &lt;span class=\"hljs-title\"&gt;RunCommand&lt;/span&gt;&lt;span class=\"hljs-params\"&gt;(&lt;span class=\"hljs-type\"&gt;int32_t&lt;/span&gt; commandId, ksapi::ksRunCommandModeEnum mode)&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=\"hljs-keyword\"&gt;switch&lt;/span&gt; (commandId)\n    {\n        &lt;span class=\"hljs-keyword\"&gt;case&lt;/span&gt; &lt;span class=\"hljs-number\"&gt;1&lt;/span&gt;:\n        {\n            &lt;span class=\"hljs-comment\"&gt;// Создание и инициализация макрообъекта&lt;/span&gt;\n            Orifice * macroObj = &lt;span class=\"hljs-keyword\"&gt;new&lt;/span&gt; &lt;span class=\"hljs-built_in\"&gt;Orifice&lt;/span&gt;();\n            &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;InitProcessParam&lt;/span&gt;())\n                macroObj-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;ChoiceFaces&lt;/span&gt;();\n            &lt;span class=\"hljs-keyword\"&gt;break&lt;/span&gt;;\n        }\n    }\n}\n\n&lt;span class=\"hljs-comment\"&gt;// Загрузка библиотеки&lt;/span&gt;\n&lt;span class=\"hljs-built_in\"&gt;APP_EXP_FUNC&lt;/span&gt;(&lt;span class=\"hljs-type\"&gt;bool&lt;/span&gt;) &lt;span class=\"hljs-built_in\"&gt;LoadKompasLibrary&lt;/span&gt;(ksapi::IApplication &amp;amp; app, ksapi::IKompasLibraryActions &amp;amp; libraryActions)\n{\n    libraryActions.&lt;span class=\"hljs-built_in\"&gt;AddGetApplicationVersion&lt;/span&gt;(GetApplicationVersion);\n    libraryActions.&lt;span class=\"hljs-built_in\"&gt;AddRunCommandHandler&lt;/span&gt;(RunCommand);\n    libraryActions.&lt;span class=\"hljs-built_in\"&gt;AddGetLibraryPropertiesObjectHandler&lt;/span&gt;(LibPropObjectEntry);\n    libraryActions.&lt;span class=\"hljs-built_in\"&gt;AddGetMenuIdHandler&lt;/span&gt;(GetMenuId);\n\n    ksAppl = &amp;amp;app;\n\n    &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (ksapi::ILibraryManagerPtr libraryManager = app.&lt;span class=\"hljs-built_in\"&gt;GetLibraryManager&lt;/span&gt;())\n    {\n        &lt;span class=\"hljs-keyword\"&gt;if&lt;/span&gt; (ksapi::IProceduresLibrariesPtr proceduresLibraries = libraryManager-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetProceduresLibraries&lt;/span&gt;())\n            myLibrary = proceduresLibraries-&amp;gt;&lt;span class=\"hljs-built_in\"&gt;GetItemByName&lt;/span&gt;(&lt;span class=\"hljs-string\"&gt;L\"MacroObj\"&lt;/span&gt;);\n    }\n\n    &lt;span class=\"hljs-keyword\"&gt;return&lt;/span&gt; &lt;span class=\"hljs-literal\"&gt;true&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n        &lt;button class=\"yfm-clipboard-button\"&gt;\n            &lt;svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-icon\" data-animation=\"1364\"&gt;\n                &lt;path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"&gt;&lt;/path&gt;\n                &lt;path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\"&gt;\n                    &lt;animate id=\"visibileAnimation-1364\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin&gt;&lt;/animate&gt;\n                    &lt;animate id=\"hideAnimation-1364\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-1364.end+1\" fill=\"freeze\"&gt;&lt;/animate&gt;\n                &lt;/path&gt;\n            &lt;/svg&gt;\n        &lt;/button&gt;\n    &lt;/div&gt;\n","meta":{"metadata":[{"name":"generator","content":"Diplodoc Platform v5.15.6"}],"alternate":[{"href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html","hreflang":"ru"}],"script":["_bundle/mermaid-extension.js"],"canonical":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html","vcsPath":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.md"},"headings":[{"title":"Иерархия наследования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#ierarhiya-nasledovaniya","level":2},{"title":"Общее описание","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#obshee-opisanie","level":2},{"title":"Важные примечания","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#vazhnye-primechaniya","level":2},{"title":"Получение интерфейса","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#poluchenie-interfejsa","level":2},{"title":"Дополнительные интерфейсы","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#dopolnitelnye-interfejsy","level":2},{"title":"Методы интерфейса","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#metody-interfejsa","level":2,"items":[{"title":"Группа 1: Основные параметры и размещение","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-1-osnovnye-parametry-i-razmeshenie","level":3},{"title":"Группа 2: Управление содержимым","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-2-upravlenie-soderzhimym","level":3},{"title":"Группа 3: Флаги редактирования и специальные флаги","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-3-flagi-redaktirovaniya-i-specialnye-flagi","level":3},{"title":"Группа 4: Характерные точки","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-4-harakternye-tochki","level":3},{"title":"Группа 5: Присоединенные выноски","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-5-prisoedinennye-vynoski","level":3},{"title":"Группа 6: Преобразование координат","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#gruppa-6-preobrazovanie-koordinat","level":3},{"title":"GetPlacement / SetPlacement","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getplacement-/-setplacement","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya","level":4}]},{"title":"SetName / GetName","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setname-/-getname","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya1","level":4}]},{"title":"GetLabel","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getlabel","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya2","level":4}]},{"title":"AddObjects / SetObjects","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#addobjects-/-setobjects","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya3","level":4}]},{"title":"FindObject","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#findobject","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya4","level":4}]},{"title":"SetDoubleClickEditable / IsDoubleClickEditable","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setdoubleclickeditable-/-isdoubleclickeditable","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya5","level":4}]},{"title":"SetHotPointsEditable / IsHotPointsEditable","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#sethotpointseditable-/-ishotpointseditable","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya6","level":4}]},{"title":"SetExternalEditable / IsExternalEditable","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setexternaleditable-/-isexternaleditable","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya7","level":4}]},{"title":"SetPropertyObjectEditable / IsPropertyObjectEditable","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setpropertyobjecteditable-/-ispropertyobjecteditable","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya8","level":4}]},{"title":"SetCreateSpcObjects / IsCreateSpcObjects","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setcreatespcobjects-/-iscreatespcobjects","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya9","level":4}]},{"title":"SetBreakObjectsEnabled / IsBreakObjectsEnabled","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#setbreakobjectsenabled-/-isbreakobjectsenabled","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya10","level":4}]},{"title":"AddDefaultHotPoint / DeleteDefaultHotPoint","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#adddefaulthotpoint-/-deletedefaulthotpoint","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya11","level":4}]},{"title":"GetAttachedLeaders / DeleteAttachedLeaders","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#getattachedleaders-/-deleteattachedleaders","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya12","level":4}]},{"title":"TransformPointToView / TransformPointFromView","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#transformpointtoview-/-transformpointfromview","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya13","level":4}]},{"title":"TransformAngleToView / TransformAngleFromView","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#transformangletoview-/-transformanglefromview","level":3,"items":[{"title":"Пример использования","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#primer-ispolzovaniya14","level":4}]}]},{"title":"Частые ошибки","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#chastye-oshibki","level":2,"items":[{"title":"1. Забывают вызывать Update()","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#1-zabyvayut-vyzyvat-update","level":3},{"title":"2. Использование невалидных указателей","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#2-ispolzovanie-nevalidnyh-ukazatelej","level":3},{"title":"3. Несоответствие систем координат","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#3-nesootvetstvie-sistem-koordinat","level":3},{"title":"4. Множественное добавление характерных точек","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#4-mnozhestvennoe-dobavlenie-harakternyh-tochek","level":3},{"title":"5. Неправильное использование SmartPtr","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#5-nepravilnoe-ispolzovanie-smartptr","level":3},{"title":"6. Непроверка указателей после приведения SmartPtr","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#6-neproverka-ukazatelej-posle-privedeniya-smartptr","level":3}]},{"title":"Шаблоны кода из исходников","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#shablony-koda-iz-ishodnikov","level":2,"items":[{"title":"Типичная структура обработки макрообъекта (из Orifice.cpp)","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#tipichnaya-struktura-obrabotki-makroobuekta-iz-orificecpp","level":3},{"title":"Работа с пользовательскими данными (из Orifice.cpp)","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#rabota-s-polzovatelskimi-dannymi-iz-orificecpp","level":3},{"title":"Инициализация библиотеки (из MacroObj.cpp)","href":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject.html#inicializaciya-biblioteki-iz-macroobjcpp","level":3}]}],"title":"&lt;strong&gt;Интерфейс IMacroObject&lt;/strong&gt;"},"router":{"pathname":"ru/kompas-api-apps/documents/2d-documents/view/object-collections/graphic-objects/IMacroObject","depth":8,"base":"../../../../../../../"},"lang":"ru","langs":["ru"],"viewerInterface":{"toc":true,"search":true,"feedback":true}}
        </script>
        <script type="application/javascript">
            const data = document.querySelector('script#diplodoc-state');
            window.__DATA__ = JSON.parse((function unescape(string) {
                return string.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&");
              })(data.innerText));
            window.STATIC_CONTENT = false;
        </script>
        <script type="application/javascript" defer src="ru/toc.js"></script>
        <script type="application/javascript" defer src="_bundle\vendor-cc74e4dafed769a9.js"></script>
        <script type="application/javascript" defer src="_bundle\react-23c48c44d4a3ad02.js"></script>
        <script type="application/javascript" defer src="_bundle\app-ba6364e2395fcb2b.js"></script>
        <script type="application/javascript" defer src="_bundle/mermaid-extension.js"></script>
        
    </body>
</html>